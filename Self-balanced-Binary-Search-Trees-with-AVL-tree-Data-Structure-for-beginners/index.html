<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="author" content="Adrian Mejia">
    <link rel="author" href="humans.txt" />
    <meta name="description" content="JavaScript tutorials and web development articles including topics like NodeJS, Angular, VueJS, Data Structures and Algorithms.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">

    <link rel="alternative" href="/atom.xml" title="Adrian Mejia Blog" type="application/atom+xml">

    
    <title>Self-balanced Binary Search Trees with AVL in JavaScript | Adrian Mejia Blog</title>

    <!-- Favicons -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content="Adrian Mejia's Blog"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="/mstile-310x310.png" />
    <meta name="msapplication-notification" content="frequency=30;polling-uri=http://notifications.buildmypinnedsite.com/?feed=https://adrianmejia.com/atom.xml" />

    <link rel="canonical" href="https://adrianmejia.com/self-balanced-binary-search-trees-with-avl-tree-data-structure-for-beginners/" />
    <!-- Open Graph -->
    <meta property="og:url" content="https://adrianmejia.com/Self-balanced-Binary-Search-Trees-with-AVL-tree-Data-Structure-for-beginners/" />
    <meta property="og:site_name" content="Adrian Mejia Blog" />
    <meta property="og:type" content="article" />
    <meta property="og:description" content="


Binary Search Trees (BST) is used for many things that we might not be aware of. For instance: in compilers to generate syntax trees, cryptography and in compressions algorithms used in JPG and MP3. However, search trees need to be balanced to be fast. So, we are going to discuss how to keep the BST balanced as you add and remove elements." />
    <meta property="og:image" content="https://adrianmejia.com/images/data-structures-algorithms-avl-binary-search-trees-large.jpg" />
    <meta property="og:title" content="Self-balanced Binary Search Trees with AVL in JavaScript" />
    <meta property="fb:app_id" content="761831487293468" />
    <meta property="fb:admins" content="895685163"/>
    <!-- /Open Graph -->

    <script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-24183929-4', 'auto');
ga('send', 'pageview');
</script><script async defer src='https://www.google-analytics.com/analytics.js'></script>


    <!-- Critical Styles -->
    <style media="screen">
      .overlay { display: none }
    </style>
    
<link rel="stylesheet" href="/stylesheets/main.css">

    <!-- loadDeferredStyles -->
    <noscript id="deferred-styles">
      
<link rel="stylesheet" href="/stylesheets/font-awesome.min.css">
    </noscript>

    <script>
      var loadDeferredStyles = function() {
        var addStylesNode = document.getElementById("deferred-styles");
        var replacement = document.createElement("div");
        replacement.innerHTML = addStylesNode.textContent;
        document.body.appendChild(replacement)
        addStylesNode.parentElement.removeChild(addStylesNode);
      };
      var raf = requestAnimationFrame || mozRequestAnimationFrame ||
          webkitRequestAnimationFrame || msRequestAnimationFrame;
      if (raf) raf(function() { window.setTimeout(loadDeferredStyles, 0); });
      else window.addEventListener('load', loadDeferredStyles);
    </script>

  <meta name="generator" content="Hexo 5.0.2"></head>
  <body>
    <header class="titlebar mdl-shadow--2dp">
      <div class="container align-center flexbox--space-between">
        <!-- <div class="row"> -->
          <!-- <div class="col-md-12"> -->
            <span class="hidden-mobile-up">
              <i class="fa fa-bars" aria-hidden="true"></i>
            </span>

            <a href="/" class="align-center m-y-2">
              <img src="/images/adrianmejia-logo.png" alt="Adrian Mejia Logo" class="animation--bounce-in"/>
              <h1 class="hidden-mobile-down hidden">
                Adrian Mejia
              </h1>
            </a>

            <nav class="hidden-mobile-down navbar">
              
                <a href="/#home" class="animation--radial-out" id="Home" onclick="track('/#home', 'menu', true)">Home</a>
              
                <a href="/#trending-posts" class="animation--radial-out" id="Trending" onclick="track('/#trending-posts', 'menu', true)">Trending</a>
              
                <a href="/#popular-posts" class="animation--radial-out" id="Popular" onclick="track('/#popular-posts', 'menu', true)">Popular</a>
              
                <a href="/#about" class="animation--radial-out" id="About" onclick="track('/#about', 'menu', true)">About</a>
              
                <a href="/blog/" class="animation--radial-out" id="Blog" onclick="track('/blog/', 'menu', true)">Blog</a>
              
            </nav>

            <a href="#" id="search-modal" onclick="track('#search', 'search', true)" class="open-overlay">
  <i class="fa fa-search" aria-hidden="true"></i>
</a>

<div id="search-overlay" class="overlay" aria-hidden="true">

  <script id="movie" type="text/x-handlebars-template">
    <article class="movie">
      {{#photos.0}}
      <a href="/{{path}}">
        <img class="movie-image" src="{{photos.0}}" />
      </a>
      {{/photos.0}}

      <div class="movie-meta">
        <div class="movie-title">
          <a href="/{{path}}">
            {{{_highlightResult.title.value}}}
          </a>
          <span class="movie-year">
            {{updatedYear}}
          </span>
        </div>

        <div class="movie-rating">
          {{#stars}}
            <span class="ais-star-rating--star{{^.}}__empty{{/.}}">
            </span>
          {{/stars}}
        </div>

        <p>
          {{{_highlightResult.excerptStrip.value}}}
        </p>

        <div class="movie-genres">
          {{#tags}}
            <div class="movie-genre">
              {{.}}
            </div>
          {{/tags}}
        </div>
      </div>
    </article>
  </script>

  <div class="search-container">

    <div class="top">
      <div class="search-button">
        <i class="fa fa-search"></i>
      </div>
      <div class="input-container">
        <input type="text" id="search-box" />
        <div id="stats"></div>
      </div>
      <a href="#" class="close-overlay">
        <i class="fa fa-times"></i>
      </a>
    </div>

    <div class="content">
      <div class="facets">

        <div class="facet">
          <div id="clear-all" class="facet-title"></div>
        </div>

        <div class="facet">
          <div class="facet-title">
            <i class="fa fa-tags" aria-hidden="true"></i> Tags
          </div>
          <div id="tags"></div>
        </div>

        <div class="facet">
          <div class="facet-title">
            <i class="fa fa-folder-o" aria-hidden="true"></i>
            Categories
          </div>
          <div id="categories"></div>
        </div>

        <div class="facet">
          <div class="facet-title">
            <i class="fa fa-eye" aria-hidden="true"></i>
            Views
          </div>
          <div id="ratings"></div>
        </div>

        <div class="facet">
          <div class="facet-title">
            <i class="fa fa-calendar" aria-hidden="true"></i>
            Year
          </div>
          <div id="year"></div>
        </div>
      </div>

      <div class="canvas">
        <div id="hits"></div>

        <div id="pagination"></div>

        <div>Powered by <img src="/images/Algolia_logo_bg-white.svg" height="30" alt="Algolia search"></div>
      </div>
    </div>
  </div>
</div>


<script src="/js/search.babel.js"></script>


      </div>
    </header>
    <nav class="hidden-mobile-up mdl-shadow--2dp">
      <div class="container flexbox--space-between navbar">
        
          <a href="/#home" class="animation--underline-from-center">Home</a>
        
          <a href="/#trending-posts" class="animation--underline-from-center">Trending</a>
        
          <a href="/#popular-posts" class="animation--underline-from-center">Popular</a>
        
          <a href="/#about" class="animation--underline-from-center">About</a>
        
          <a href="/blog/" class="animation--underline-from-center">Blog</a>
        
      </div>
    </nav>

    <main>
      <!--https://developers.google.com/search/docs/data-types/articles-->
<!--http://schema.org/BlogPosting-->
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": ""
  },
  "headline": "Self-balanced Binary Search Trees with AVL in JavaScript",
  
  "image": {
    "@type": "ImageObject",
    "url": "https://adrianmejia.com/images/data-structures-algorithms-avl-binary-search-trees-large.jpg",
    "height": 360,
    "width": 728
  },
  
  "datePublished": "2018-07-16T15:43:11-04:00",
  "dateModified": "2019-05-30T15:43:11-04:00",
  "author": {
    "@type": "Person",
    "name": "Adrian Mejia"
  },
   "publisher": {
    "@type": "Organization",
    "name": "Adrian Mejia",
    "logo": {
      "@type": "ImageObject",
      "url": "https://adrianmejia.com/images/logo.png",
      "width": 347,
      "height": 50
    }
  },
  "description": "


Binary Search Trees (BST) is used for many things that we might not be aware of. For instance: in compilers to generate syntax trees, cryptography and in compressions algorithms used in JPG and MP3. However, search trees need to be balanced to be fast. So, we are going to discuss how to keep the BST balanced as you add and remove elements."
}
</script>


<article class="container post">

  <section class="hero">
    <div class="muted">
      <a class="category-link" href="/categories/coding/">Coding</a> > <a class="category-link" href="/categories/coding/data-structures-and-algorithms-dsa/">Data Structures and Algorithms (DSA)</a>
    </div>

    <h1>Self-balanced Binary Search Trees with AVL in JavaScript</h1>

    <div class="muted">
      <span title="Last time this post was updated">
        <i class="fa fa-calendar" aria-hidden="true"></i>
        Last updated
        <time datetime="2019-05-30T19:43:11.000Z" itemprop="dateUpdated">May 30th 2019</time>
      </span>

      
        <span class="m-x-2" title="Pageviews">
          <i class="fa fa-eye" aria-hidden="true"></i>
          17.9k
        </span>
      

      <span class="m-x-2" title="Click to go to the comments section">
        <a href="#disqus_thread">
          <i class="fa fa-comment-o" aria-hidden="true"></i>
          <span class="disqus-comment-count" data-disqus-url="https://adrianmejia.com/Self-balanced-Binary-Search-Trees-with-AVL-tree-Data-Structure-for-beginners/">0</span>
        </a>
      </span>

      
        <span>
          <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithms/" rel="tag">algorithms</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tutorial-algorithms/" rel="tag">tutorial_algorithms</a><span class="tag-list-count">10</span></li></ul>
        </span>
      
    </div>
  </section>

  <div class="art-container" style="background-color: #F4F0EF">
    
      <picture>
        <source media="(min-width: 728px)" srcset="/images/data-structures-algorithms-avl-binary-search-trees-large.jpg">
        <source srcset="/images/data-structures-algorithms-avl-binary-search-trees-small.jpg">
        <img src="/images/data-structures-algorithms-avl-binary-search-trees-large.jpg" alt="Self-balanced Binary Search Trees with AVL in JavaScript">
      </picture>
    
  </div>

  <div class="row">
    <section class="col-sm-8 p-x-2">

      <div class="post-content  toc-content ">
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML" async></script>


<p>Binary Search Trees (BST) is used for many things that we might not be aware of. For instance: in compilers to generate syntax trees, cryptography and in compressions algorithms used in JPG and MP3. However, search trees need to be balanced to be fast. So, we are going to discuss how to keep the BST balanced as you add and remove elements.</p>
<a id="more"></a>

<p>In this post, we are going to explore different techniques to balance a tree. We are going to use rotations to move nodes around and the AVL algorithm to keep track if the tree is balanced or needs adjustments. Let’s dig in!</p>
<p>You can find all these implementations and more in the Github repo:
<a target="_blank" rel="noopener" href="https://github.com/amejiarosario/dsa.js">https://github.com/amejiarosario/dsa.js</a></p>
<hr>
<p>This post is part of a tutorial series:</p>
<p><strong>Learning Data Structures and Algorithms (DSA) for Beginners</strong></p>
<ol>
<li><p><a href="/blog/2018/04/04/how-you-can-change-the-world-learning-data-structures-algorithms-free-online-course-tutorial/">Intro to algorithm’s time complexity and Big O notation</a></p>
<!-- 1. Intro to Algorithm's Time Complexity and Big O Notation **👈 you are here** -->
</li>
<li><p><a href="/blog/2018/04/05/most-popular-algorithms-time-complexity-every-programmer-should-know-free-online-tutorial-course/">Eight time complexities that every programmer should know</a></p>
<!-- 1. Eight time complexities that every programmer should know **👈 you are here** -->
</li>
<li><p><a href="/blog/2018/04/28/Data-Structures-Time-Complexity-for-Beginners-Arrays-HashMaps-Linked-Lists-Stacks-Queues-tutorial/">Data Structures for Beginners: Arrays, HashMaps, and Lists</a></p>
<!-- 1. Data Structures for Beginners: Arrays, HashMaps, and Lists **👈 you are here** -->
</li>
<li><p><a href="/blog/2018/05/14/Data-Structures-for-Beginners-Graphs-Time-Complexity-tutorial/">Graph Data Structures for Beginners</a></p>
<!-- 1. Graph Data Structures for Beginners **👈 you are here** -->
</li>
<li><p><a href="/blog/2018/06/11/Data-Structures-for-Beginners-Trees-binary-search-tree-tutorial/">Trees Data Structures for Beginners</a></p>
<!-- 1. Trees Data Structures for Beginners **👈 you are here** -->
</li>
<li><p>Self-balanced Binary Search Trees <strong>👈 you are here</strong></p>
</li>
<li><p><a href="/blog/2018/04/24/Analysis-of-Recursive-Algorithms/">Appendix I: Analysis of Recursive Algorithms</a></p>
</li>
</ol>
<hr>
<p>Let’s start by defining what is a “balanced tree” and the pitfalls of an “unbalanced tree”.</p>
<h2 id="Balanced-vs-Unbalanced-Binary-Search-Tree"><a href="#Balanced-vs-Unbalanced-Binary-Search-Tree" class="headerlink" title="Balanced vs. Unbalanced Binary Search Tree"></a>Balanced vs. Unbalanced Binary Search Tree</h2><p>As discussed in the
<a href="/blog/2018/06/11/data-structures-for-beginners-trees-binary-search-tree-tutorial/">previous post</a>
the worst nightmare for a BST is to be given numbers in order (e.g. 1, 2, 3, 4, 5, 6, 7, …).</p>
<img src="/images/balanced-vs-non-balanced-tree.jpg" class="" title="Balanced vs. unbalanced Tree">

<p>If we ended up with a tree like the one on the left, we are screwed because performance will go to the floor. To find out if a node is on the tree or not, you will have to visit every node when the tree is unbalanced. That takes <em>O(n)</em>, while if we keep the node balanced in every insertion or deletion, we could have <em>O(log n)</em>.</p>
<p>Again, this might not look like a big difference, but when you have a million nodes, the difference is huge! We are talking about visiting <code>1,000,000</code>  nodes vs. visiting <code>20</code>!</p>
<p>“Ok, I’m sold. How do I keep the tree balanced?” I’m glad you asked 😉. Well, let’s first learn when to tell that a tree is unbalanced.</p>
<h2 id="When-a-tree-is-balanced-non-balanced"><a href="#When-a-tree-is-balanced-non-balanced" class="headerlink" title="When a tree is balanced/non-balanced?"></a>When a tree is balanced/non-balanced?</h2><p>Take a look at the following trees and tell which one is balanced and which one is not.</p>
<img src="/images/full-complete-perfect-binary-tree.jpg" class="" title="Full vs. Complete vs. Perfect Binary Tree">

<p>Well, a tree is definately balanced when is a perfect tree (all the levels on the tree have maximum number of nodes). But what about
<a href="/blog/2018/06/11/data-structures-for-beginners-trees-binary-search-tree-tutorial/#Full-Complete-and-Perfect-binary-trees">full trees</a>
or
<a href="/blog/2018/06/11/data-structures-for-beginners-trees-binary-search-tree-tutorial/#Full-Complete-and-Perfect-binary-trees">complete trees</a>
?</p>
<p>The “complete tree” looks somewhat balanced, right? What about the full tree? Well, it starts to get tricky. Let’s work on a definition.</p>
<p>A tree is <strong>balanced</strong> if:</p>
<ol>
<li>The left subtree height and the right subtree height differ by at most 1.</li>
<li>Visit every node making sure rule <strong>#1</strong> is satisfied.</li>
</ol>
<blockquote>
<p>Note: Height of a node is the distance (edge count) from the farthest child to itself.</p>
</blockquote>
<p>For instance, if you have a tree with seven nodes:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    10</span><br><span class="line">   &#x2F;   \</span><br><span class="line">  5    20</span><br><span class="line"> &#x2F;     &#x2F; \</span><br><span class="line">4    15   30</span><br><span class="line">     &#x2F;</span><br><span class="line">    12</span><br></pre></td></tr></table></figure>

<p>If you check the subtrees’
<a href="/blog/2018/06/11/data-structures-for-beginners-trees-binary-search-tree-tutorial/#Trees-basic-concepts">heights</a> (edge counts to farthest leaf node)
recursively you will notice they never differ by more than one.</p>
<ul>
<li><code>10</code> descendants:<ul>
<li>Left subtree <code>5</code> has a height of 1, while right subtree <code>20</code> has a height of <code>2</code>. The difference is one so: <strong>Balanced</strong>!</li>
</ul>
</li>
<li><code>20</code> descendants:<ul>
<li>Left subtree<code>15</code> has a height of <code>1</code>, while right subtree <code>30</code> has a height of 0. So the diff is <code>1</code>:  <strong>Balanced</strong>!</li>
</ul>
</li>
</ul>
<p>On the other hand, take a look at this tree:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">     40</span><br><span class="line">   &#x2F;   \</span><br><span class="line">  35    60*</span><br><span class="line"> &#x2F;     &#x2F;</span><br><span class="line">25    50</span><br><span class="line">     &#x2F;</span><br><span class="line">    45</span><br></pre></td></tr></table></figure>

<p>Let’s check the height of the subtree recursively:</p>
<ul>
<li><code>40</code> descendants:<ul>
<li>Left subtree <code>35</code> has a height of 1, while right subtree <code>60</code> has a height of <code>2</code>. The difference is one so: <strong>Balanced</strong>!</li>
</ul>
</li>
<li><code>60</code> descendants:<ul>
<li>Left subtree <code>50</code> has a height of <code>2</code>, while the right subtree (none) has a height of <code>0</code>. The difference between <code>2</code> and <code>0</code> is more than one, so: <strong>NOT balanced</strong>!</li>
</ul>
</li>
</ul>
<p>Hopefully, now you can calculate balanced and unbalanced trees.</p>
<p>What can we do when we find an unbalanced tree? We do rotations!</p>
<p>If we take the same tree as before and move <code>50</code> to the place of <code>60</code> we get the following:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">     40</span><br><span class="line">   &#x2F;   \</span><br><span class="line">  35    50</span><br><span class="line"> &#x2F;     &#x2F;   \</span><br><span class="line">25    45    60*</span><br></pre></td></tr></table></figure>
<p>After rotating <code>60</code> to the right, It’s balanced! Let’s learn all about it in the next section.</p>
<h2 id="Tree-rotations"><a href="#Tree-rotations" class="headerlink" title="Tree rotations"></a>Tree rotations</h2><p>Before throwing any line of code, let’s spend some time thinking about how to balance small trees using rotations.</p>
<h3 id="Left-Rotation"><a href="#Left-Rotation" class="headerlink" title="Left Rotation"></a>Left Rotation</h3><p>Let’s say that we have the following tree with ascending values: <code>1-2-3</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1*                                        2</span><br><span class="line"> \                                       &#x2F;  \</span><br><span class="line">  2     ---| left-rotation(1) |--&gt;      1*   3</span><br><span class="line">   \</span><br><span class="line">    3</span><br></pre></td></tr></table></figure>

<p>To perform a left rotation on node <code>1</code>, we move it down as it’s children’s (<code>2</code>) <strong>left</strong> descendant.</p>
<img src="/images/left-rotation2.gif" class="" title="Left rotate on 2">

<p>This is called <strong>single left rotation</strong> or <strong>Left-Left (LL) rotation</strong>.</p>
<p>For the coding part, let’s do another example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1                                 1</span><br><span class="line"> \                                 \</span><br><span class="line">  2*                                3</span><br><span class="line">   \    --left-rotation(2)-&gt;       &#x2F; \</span><br><span class="line">    3                             2*  4</span><br><span class="line">     \</span><br><span class="line">      4</span><br></pre></td></tr></table></figure>

<p>To define the tree, we are using
<a target="_blank" rel="noopener" href="https://github.com/amejiarosario/dsa.js/blob/master/src/data-structures/trees/tree-node.js">TreeNode </a>
that we developed in the
<a href="https://adrianmejia.com/blog/2018/06/11/data-structures-for-beginners-trees-binary-search-tree-tutorial/#BST-Implementation">previous post</a>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> n1 = <span class="keyword">new</span> TreeNode(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">const</span> n2 = <span class="keyword">new</span> TreeNode(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">const</span> n3 = <span class="keyword">new</span> TreeNode(<span class="number">3</span>);</span><br><span class="line"><span class="keyword">const</span> n4 = <span class="keyword">new</span> TreeNode(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">n1.right = n2;</span><br><span class="line">n2.right = n3;</span><br><span class="line">n3.right = n4;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> newParent = leftRotation(n2);</span><br><span class="line"><span class="built_in">console</span>.log(newParent === n3); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>In this case, we are rotating 2 to the left. Let’s implement the <code>leftRotation</code> function.</p>
<figure class="highlight js"><figcaption><span>leftRotation</span><a target="_blank" rel="noopener" href="https://github.com/amejiarosario/dsa.js/blob/master/src/data-structures/trees/tree-rotations.js">Code</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">leftRotation</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> newParent = node.right; <span class="comment">// e.g. 3</span></span><br><span class="line">  <span class="keyword">const</span> grandparent = node.parent; <span class="comment">// e.g. 1</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// make 1 the parent of 3 (previously was the parent of 2)</span></span><br><span class="line marked">  swapParentChild(node, newParent, grandparent);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// do LL rotation</span></span><br><span class="line">  newParent.left = node; <span class="comment">// makes 2 the left child of 3</span></span><br><span class="line">  node.right = <span class="literal">undefined</span>; <span class="comment">// clean 2&#x27;s right child</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> newParent; <span class="comment">// 3 is the new parent (previously was 2)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Notice that we are using a utility function to swap parents called <code>swapParentChild</code>.</p>
<figure class="highlight js"><figcaption><span>swapParentChild</span><a target="_blank" rel="noopener" href="https://github.com/amejiarosario/dsa.js/blob/master/src/data-structures/trees/tree-rotations.js">Code</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">swapParentChild</span>(<span class="params">oldChild, newChild, parent</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (parent) &#123;</span><br><span class="line">    <span class="keyword">const</span> side = oldChild.isParentRightChild ? <span class="string">&#x27;right&#x27;</span> : <span class="string">&#x27;left&#x27;</span>;</span><br><span class="line">    <span class="comment">// this set parent child AND also</span></span><br><span class="line">    parent[side] = newChild;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// no parent? so set it to null</span></span><br><span class="line">    newChild.parent = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We are using this function to make <code>1</code> the parent of <code>3</code>. We are going to use it rotation right as well.</p>
<h3 id="Right-Rotation"><a href="#Right-Rotation" class="headerlink" title="Right Rotation"></a>Right Rotation</h3><p>We have the following tree with descending values <code>4-3-2-1</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">      4                                        4</span><br><span class="line">     &#x2F;                                        &#x2F;</span><br><span class="line">    3*                                       2</span><br><span class="line">   &#x2F;                                        &#x2F;  \</span><br><span class="line">  2       ---| right-rotation(3) |--&gt;      1    3*</span><br><span class="line"> &#x2F;</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p>To perform a right rotation on node <code>3</code>, we move it down as its child <code>2</code>‘s <strong>right</strong> descendant.</p>
<img src="/images/right-rotation2.gif" class="" title="Left rotate on 2">

<p>This is called <strong>single right rotation</strong> or <strong>Right-Right (RR) rotation</strong>.</p>
<p>The code is pretty similar to what we did on the left rotation:</p>
<figure class="highlight js"><figcaption><span>rightRotation</span><a target="_blank" rel="noopener" href="https://github.com/amejiarosario/dsa.js/blob/master/src/data-structures/trees/tree-rotations.js">Code</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">rightRotation</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> newParent = node.left;</span><br><span class="line">  <span class="keyword">const</span> grandparent = node.parent;</span><br><span class="line"></span><br><span class="line marked">  swapParentChild(node, newParent, grandparent);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// do RR rotation</span></span><br><span class="line marked">  newParent.right = node;</span><br><span class="line marked">  node.left = <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> newParent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The <code>rightRotation</code> does the following:</p>
<ol>
<li>First, we swap <code>4</code>‘s child: before it was <code>3</code> and after the swap is <code>2</code> (line 5).</li>
<li>Later, we make <code>3</code> the <strong>right</strong> child of 2 (line 8) and</li>
<li>Finally, we clean up the <code>3</code> right child reference to null (line 9).</li>
</ol>
<p>Now that know how single rotations work to the left and right we can combine them: left-right and right-left rotations.</p>
<h3 id="Left-Right-Rotation"><a href="#Left-Right-Rotation" class="headerlink" title="Left-Right Rotation"></a>Left-Right Rotation</h3><p>If we insert values on a BST in this order: 3-1-2. We will get an unbalanced tree. To balance the tree, we have to do a <code>leftRightRotation(3)</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  3*                                       2*</span><br><span class="line"> &#x2F;                                        &#x2F;  \</span><br><span class="line">1    --| left-right-rotation(3) |-&gt;      1    3</span><br><span class="line"> \</span><br><span class="line">  2</span><br></pre></td></tr></table></figure>

<p>Double rotations are a combination of the other two rotations we discussed in (LL and RR):</p>
<p>If we expand the <code>left-right-rotation</code> into the two single rotations we would have:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  3*                          3*</span><br><span class="line"> &#x2F;                          &#x2F;                            2</span><br><span class="line">1   -left-rotation(1)-&gt;    2    -right-rotation(3)-&gt;    &#x2F;  \</span><br><span class="line"> \                        &#x2F;                            1    3*</span><br><span class="line">  2                      1</span><br></pre></td></tr></table></figure>

<ul>
<li>left-rotation(1): We do a left rotation on the nodes’ left child. E.g. <code>1</code>.</li>
<li>right-rotation(3): right rotation on the same node. E.g. <code>3</code>.</li>
</ul>
<img src="/images/left-right-rotation.gif" class="" title="Left-Right rotate on 2">

<p>This double rotation is called <strong>Left-Right (LR) rotation</strong>.</p>
<figure class="highlight js"><figcaption><span>leftRightRotation</span><a target="_blank" rel="noopener" href="https://github.com/amejiarosario/dsa.js/blob/master/src/data-structures/trees/tree-rotations.js">Code</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">leftRightRotation</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">  leftRotation(node.left);</span><br><span class="line">  <span class="keyword">return</span> rightRotation(node);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The code is straightforward since we leverage the <code>leftRotation</code> and <code>rightRotation</code> that we did before.</p>
<h3 id="Right-Left-Rotation"><a href="#Right-Left-Rotation" class="headerlink" title="Right-Left Rotation"></a>Right-Left Rotation</h3><p>When we insert nodes on the following order: <code>1-3-2</code>, we need to perform a <code>rightLeftRotation(1)</code> to balance the tree.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1*                           1*</span><br><span class="line"> \                            \                              2</span><br><span class="line">   3   -right-rotation(3)-&gt;    2   -left-rotation(1)-&gt;      &#x2F;  \</span><br><span class="line"> &#x2F;                              \                          1*   3</span><br><span class="line">2                                3</span><br></pre></td></tr></table></figure>

<p>The code to is very similar to LR rotation:</p>
<figure class="highlight js"><figcaption><span>leftRightRotation</span><a target="_blank" rel="noopener" href="https://github.com/amejiarosario/dsa.js/blob/master/src/data-structures/trees/tree-rotations.js">Code</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">rightLeftRotation</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">  rightRotation(node.right);</span><br><span class="line">  <span class="keyword">return</span> leftRotation(node);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We know all the rotations needed to balanced any binary tree. Let’s go ahead, use the AVL algorithm to keep it balanced on insertions/deletions.</p>
<h2 id="AVL-Tree-Overview"><a href="#AVL-Tree-Overview" class="headerlink" title="AVL Tree Overview"></a>AVL Tree Overview</h2><p><strong>AVL Tree</strong> was the first self-balanced tree invented. It is named after the two inventors <strong>A</strong>delson-<strong>V</strong>elsky and <strong>L</strong>andis. In their self-balancing algorithm if one subtree differs from the other by at most one, then rebalancing is done using rotations.</p>
<p>We already know how to do rotations from the previous sections; the next step is to figure out the subtree’s heights. We are going to call <strong>balance factor</strong>, the diff between the left and right subtree on a given node.</p>
<blockquote>
<p>balanceFactor = leftSubtreeHeight - rightSubtreeHeight</p>
</blockquote>
<p>If the balance factor is bigger than <code>1</code> or less than <code>-1</code> then, we know we need to balance that node. We can write the balance function as follows:</p>
<figure class="highlight js"><figcaption><span>Balance</span><a target="_blank" rel="noopener" href="https://github.com/amejiarosario/dsa.js/blob/master/src/data-structures/trees/tree-rotations.js#L98">Code</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">balance</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line marked">  <span class="keyword">if</span> (node.balanceFactor &gt; <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="comment">// left subtree is higher than right subtree</span></span><br><span class="line">    <span class="keyword">if</span> (node.left.balanceFactor &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      rightRotation(node);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (node.left.balanceFactor &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      leftRightRotation(node);</span><br><span class="line">    &#125;</span><br><span class="line marked">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (node.balanceFactor &lt; <span class="number">-1</span>) &#123;</span><br><span class="line">    <span class="comment">// right subtree is higher than left subtree</span></span><br><span class="line">    <span class="keyword">if</span> (node.right.balanceFactor &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      leftRotation(node);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (node.right.balanceFactor &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      rightLeftRotation(node);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Based on the balance factor, there four different rotation that we can do: RR, LL, RL, and LR. To know what rotation to do we:</p>
<ol>
<li>Take a look into the given <code>node</code>‘s <code>balanceFactor</code>.</li>
<li>If the balance factor is <code>-1</code>, <code>0</code> or <code>1</code> we are done.</li>
<li>If the node needs balancing, then we use the node’s left or right balance factor to tell which kind of rotation it needs.</li>
</ol>
<p>Notice that we haven’t implemented the <code>node.balanceFactor</code>  attribute yet, but we are going to do that next.</p>
<p>One of the easiest ways to implement subtree heights is by using recursion. Let’s go ahead and add height-related properties to <code>TreeNode</code> class:</p>
<figure class="highlight js"><figcaption><span>height, leftSubtreeHeight and rightSubtreeHeight</span><a target="_blank" rel="noopener" href="https://github.com/amejiarosario/dsa.js/blob/master/src/data-structures/trees/tree-node.js#L125">Code</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">get</span> <span class="title">height</span>() &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.max(<span class="built_in">this</span>.leftSubtreeHeight, <span class="built_in">this</span>.rightSubtreeHeight);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">get</span> <span class="title">leftSubtreeHeight</span>() &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.left ? <span class="built_in">this</span>.left.height + <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">get</span> <span class="title">rightSubtreeHeight</span>() &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.right ? <span class="built_in">this</span>.right.height + <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">get</span> <span class="title">balanceFactor</span>() &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.leftSubtreeHeight - <span class="built_in">this</span>.rightSubtreeHeight;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To understand better what’s going on, let’s do some examples.</p>
<h3 id="Tree-with-one-node"><a href="#Tree-with-one-node" class="headerlink" title="Tree with one node"></a>Tree with one node</h3><p>Let’s start with a single root node:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">  40*</span><br><span class="line">&#x2F;     \</span><br></pre></td></tr></table></figure>

<ul>
<li>Since this node doesn’t have left nor right children then <code>leftSubtreeHeight</code> and <code>rightSubtreeHeight</code> will return <code>0</code>.</li>
<li>Height is <code>Math.max(this.leftSubtreeHeight, this.rightSubtreeHeight)</code> which is  <code>Math.max(0, 0)</code>, so height is <code>0</code>.</li>
<li>Balance factor is also zero since <code>0 - 0 = 0</code>.</li>
</ul>
<h3 id="Tree-with-multiple-nodes"><a href="#Tree-with-multiple-nodes" class="headerlink" title="Tree with multiple nodes"></a>Tree with multiple nodes</h3><p>Let’s try with multiple nodes:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">     40</span><br><span class="line">   &#x2F;   \</span><br><span class="line">  35    60</span><br><span class="line"> &#x2F;     &#x2F;</span><br><span class="line">25    50</span><br><span class="line">     &#x2F;</span><br><span class="line">    45</span><br></pre></td></tr></table></figure>

<p><strong>balanceFactor(45)</strong></p>
<ul>
<li>As we saw leaf nodes doesn’t have left or right subtree, so their heights are 0, thus balance factor is 0.</li>
</ul>
<p><strong>balanceFactor(50)</strong></p>
<ul>
<li><code>leftSubtreeHeight = 1</code> and <code>rightSubtreeHeight = 0</code>.</li>
<li><code>height = Math.max(1, 0)</code>, so it’s <code>1</code>.</li>
<li>Balance factor is <code>1 - 0</code>, so it’s <code>1</code> as well.</li>
</ul>
<p><strong>balanceFactor(60)</strong></p>
<ul>
<li><code>leftSubtreeHeight = 2</code> and <code>rightSubtreeHeight = 0</code>.</li>
<li><code>height = Math.max(2, 0)</code>, so it’s <code>2</code>.</li>
<li>Balance factor is <code>2 - 0</code>, so it’s <code>2</code> and it’s UNBALANCED!</li>
</ul>
<p>If we use our <code>balance</code> function on node <code>60</code> that we developed, then it would do a <code>rightRotation</code> on <code>60</code> and the tree will look like:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">     40</span><br><span class="line">   &#x2F;   \</span><br><span class="line">  35    50</span><br><span class="line"> &#x2F;     &#x2F;   \</span><br><span class="line">25    45    60*</span><br></pre></td></tr></table></figure>

<p>Before the height of the tree (from the root) was 3, now it’s only 2.</p>
<p>Let’s put all together and explain how we can keep a binary search tree balanced on insertion and deletion.</p>
<h2 id="AVL-Tree-Insertion-and-Deletion"><a href="#AVL-Tree-Insertion-and-Deletion" class="headerlink" title="AVL Tree Insertion and Deletion"></a>AVL Tree Insertion and Deletion</h2><p>AVL tree is just a layer on top of a regular Binary Search Tree (BST). The add/remove operations are the same as in the BST, the only difference is that we run the <code>balance</code> function after each change.</p>
<p>Let’s implement the AVL Tree.</p>
<figure class="highlight js"><figcaption><span>AvlTree</span><a target="_blank" rel="noopener" href="https://github.com/amejiarosario/dsa.js/blob/master/src/data-structures/trees/avl-tree.js">Code</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> BinarySearchTree = <span class="built_in">require</span>(<span class="string">&#x27;./binary-search-tree&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AvlTree</span> <span class="keyword">extends</span> <span class="title">BinarySearchTree</span> </span>&#123;</span><br><span class="line">  add(value) &#123;</span><br><span class="line">    <span class="keyword">const</span> node = <span class="built_in">super</span>.add(value);</span><br><span class="line marked">    balanceUpstream(node);</span><br><span class="line">    <span class="keyword">return</span> node;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  remove(value) &#123;</span><br><span class="line">    <span class="keyword">const</span> node = <span class="built_in">super</span>.find(value);</span><br><span class="line">    <span class="keyword">if</span> (node) &#123;</span><br><span class="line">      <span class="keyword">const</span> found = <span class="built_in">super</span>.remove(value);</span><br><span class="line marked">      balanceUpstream(node.parent);</span><br><span class="line">      <span class="keyword">return</span> found;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>If you need to review the dependencies here are the links to the implementations:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/amejiarosario/dsa.js/blob/master/src/data-structures/trees/binary-search-tree.js">binary-search-tree</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/amejiarosario/dsa.js-data-structures-algorithms-javascript/blob/master/src/data-structures/trees/avl-tree.js#L46">balanceUpstream</a></li>
</ul>
<p>The <code>balanceUpstream</code> function gets executed after an insertion or deletion.</p>
<figure class="highlight js"><figcaption><span>balanceUpstream</span><a target="_blank" rel="noopener" href="https://github.com/amejiarosario/dsa.js-data-structures-algorithms-javascript/blob/master/src/data-structures/trees/avl-tree.js#L46">Context</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">balanceUpstream</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> current = node;</span><br><span class="line">  <span class="keyword">let</span> newParent;</span><br><span class="line">  <span class="keyword">while</span> (current) &#123;</span><br><span class="line marked">    newParent = balance(current);</span><br><span class="line">    current = current.parent;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> newParent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We go recursively using the <code>balance</code> function on the nodes’ parent until we reach the root node.</p>
<p>In the following animation, we can see AVL tree insertions and deletions in action:</p>
<img src="/images/avl-tree-insert-remove.gif" class="" title="AVL tree insertions and deletions">

<p>You can also check the
<a target="_blank" rel="noopener" href="https://github.com/amejiarosario/dsa.js/blob/master/src/data-structures/trees/avl-tree.spec.js">test files</a>
to see more detailed examples of how to use the AVL trees.</p>
<p>That’s all folks!</p>
<!-- --- -->


<!-- Perfect binary trees (when every level is full of nodes) are always balanced because their height is the lowest possible given the number of nodes. -->

<!-- \`|~ log_2 (n + 1) ~|\` -->

<!-- or -->

<!-- *`Math.ceil( Math.log2(n  + 1) )`*, where *`n`* is the total number of nodes. -->

<!-- However, perfect binary trees are not very common in the real world. We want to guarantee a search time of *`O(log n)`*. Relaxing a little bit the definition we can say that -->

<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>In this post, we explored the AVL tree, which is a particular binary search tree that self-balance itself after insertions and deletions of nodes. The operations of balancing a tree involve rotations, and they can be single or double rotations.</p>
<p>Single rotations:</p>
<ul>
<li>Left rotation</li>
<li>Right rotation</li>
</ul>
<p>Double rotations:</p>
<ul>
<li>Left-Right rotation</li>
<li>Right-Left rotation</li>
</ul>
<p>You can find all the code developed here in the
<a target="_blank" rel="noopener" href="https://github.com/amejiarosario/dsa.js/tree/master/src/data-structures/trees">Github</a>.
You can <code>star</code> it to keep it handy.</p>

      </div>

      <!-- after post -->
      <div class="hidden-mobile-down">
        <h3>Now, your turn!</h3>
        Thanks for reading this far. Here are some things you can do next:

        <ul>
          <li>Found a typo?
            <a target="_blank" rel="noopener" href="https://github.com/amejiarosario/amejiarosario.github.io/edit/source/source/_posts/2018-07-28-Self-balanced-Binary-Search-Trees-with-AVL-tree-Data-Structure-for-beginners.md">
              Edit this post</a>.
          </li>
          <li>Got questions?
            <a href="#comments-section">comment</a>
            below.
          </li>
          <li>
            Was it useful? Show your
            <!-- <a href="/support">support</a>  -->
            support and share it.
            <!-- <a target="_blank" href="http://paypal.me/amejiarosario">Paypal</a>, -->
            <!-- <a target="_blank" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=HZLFWQAFENN7W&source=url">Paypal</a>,
            <a target="_blank" href="https://bitaps.com/3A8xanut3wddz1jJ7JWSw8nwwpUahLJpZi">Bitcoin</a>,
            <a target="_blank" href="https://www.patreon.com/amejiarosario">Patreon</a>. -->
          </li>
        </ul>
      </div>

      <div class="hidden-mobile-up">
        <a target="_blank" rel="noopener" href="https://books.adrianmejia.com">
          <!-- <img src="/images/data-structure-algorithms-javascript-presell.jpg" alt="Data Structure and Algorithms in JavaScript eBook"> -->
          <img src="/images/data-structure-algorithms-banner.jpg" alt="Data Structure and Algorithms in JavaScript eBook">
        </a>
      </div>

      <!-- Next and previous posts -->
      
        <div class="article-nav m-y-4">
          
            <a href="/Vue-js-Tutorial-for-beginners-Create-a-Todo-App/" class="article-nav-newer" class="article-nav-link-wrap">
              <strong class="article-nav-caption"><i class="fa fa-chevron-left"></i> newer</strong>
              <div class="article-nav-title">
                
                  Vue.js Tutorial for beginners
                
              </div>
            </a>
          
          
            <a href="/Data-Structures-for-Beginners-Trees-binary-search-tree-tutorial/" class="article-nav-older" class="article-nav-link-wrap">
              <strong class="article-nav-caption">older <i class="fa fa-chevron-right"></i></strong>
              <div class="article-nav-title">Tree Data Structures in JavaScript for Beginners</div>
            </a>
          
        </div>
      

      

        <!-- Related -->
        <footer>
          <!-- subscribe -->
          <div class="m-y-4">
            <!-- Begin MailChimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
	#mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; width:100%;}
	/* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<form action="//adrianmejia.us2.list-manage.com/subscribe/post?u=2294bb28c5931a6f2338d2474&amp;id=52678e825b" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" novalidate>
    <div id="mc_embed_signup_scroll">
	<label for="mce-EMAIL">Subscribe &amp; stay up to date!</label>
	<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_2294bb28c5931a6f2338d2474_52678e825b" tabindex="-1" value=""></div>
    <div class="clear">&nbsp;<input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>
<!--End mc_embed_signup-->

<script type="text/javascript">
  var form = document.getElementById('mc-embedded-subscribe-form');
  form.addEventListener('submit', function(event) {
    event.preventDefault();
    ga('send', 'event', 'newsletter', 'signup', 'page', {
      hitCallback: createFunctionWithTimeout(function() {
        form.submit();
      })
    });
  });
</script>

          </div>

          <!-- Author Bio -->
          <b>About the author</b>
          
              <!-- Adrian Mejia Bio -->
            
<section class="bio-box">
  <img class="m-a-1 not-scaled" src="/images/adrian-mejia-headshot.png" alt="Adrian Mejia">
  <article class="p-x-1" style="display: flex; flex-direction:column;">
    <p class="muted">Adrian Mejia is a Software Engineer located in Boston, MA.
      Currently working at Google.
      Adrian enjoys writing posts about Algorithms, programming, JavaScript, and Web Dev.
      Also, he likes to travel ✈️ and biking 🚴‍.
      <!-- Find out more <a href="/#about">here</a>. -->
    </p>
    <!-- <p class="m-y-0"><a target="_blank" rel="noopener" href="https://twitter.com/iAmAdrianMejia">Follow him on Twitter</a>.</p> -->
    <a target="_blank" rel="noopener" href="https://twitter.com/iAmAdrianMejia" id="twitter-follow-button" class="twitter-follow-button" data-show-count="false">Follow @iAmAdrianMejia</a>&nbsp;
  </article>
</section>

          

          <div class="m-y-4">
            
              
                <div class="container">
                <h1 class="capitalize">tutorial algorithms Series</h1>
                <div class="row">
              

              <!-- <ol> -->
              <article class="col-md-6 col-sm-6 card">
  <a href="/how-to-find-time-complexity-of-an-algorithm-code-big-o-notation/">
    
      <img src="/images/from-code-to-big-o-algorithms-small.png" width="300" height="250">
      <section class="p-a-1">
        <h3>How to find time complexity of an algorithm?</h3>
      </section>
    
  </a>
</article>

              <!-- </ol> -->

              
            
              

              <!-- <ol> -->
              <article class="col-md-6 col-sm-6 card">
  <a href="/how-to-solve-any-graph-2d-arrays-maze-interview-questions-in-javascript-dfs-vs-bfs/">
    
      <img src="/images/graph-interview-questions-small.png" width="300" height="250">
      <section class="p-a-1">
        <h3>How to solve any graph/Maze interview questions in JavaScript? DFS vs. BFS</h3>
      </section>
    
  </a>
</article>

              <!-- </ol> -->

              
            
              

              <!-- <ol> -->
              <article class="col-md-6 col-sm-6 card">
  <a href="/priority-queue-data-structure-and-heaps-time-complexity-javascript-implementation/">
    
      <img src="/images/priority-queue-pq-heaps-small.png" width="300" height="250">
      <section class="p-a-1">
        <h3>Priority Queue Data Structure and Heaps Implemented in JavaScript</h3>
      </section>
    
  </a>
</article>

              <!-- </ol> -->

              
            
              

              <!-- <ol> -->
              <article class="col-md-6 col-sm-6 card">
  <a href="/how-you-can-change-the-world-learning-data-structures-algorithms-free-online-course-tutorial/">
    
      <img src="/images/data-structures-algorithms-time-complexity-big-o-notation-small.jpg" width="300" height="250">
      <section class="p-a-1">
        <h3>How you can change the world by learning Data Structures and Algorithms</h3>
      </section>
    
  </a>
</article>

              <!-- </ol> -->

              
            
              

              <!-- <ol> -->
              <article class="col-md-6 col-sm-6 card">
  <a href="/most-popular-algorithms-time-complexity-every-programmer-should-know-free-online-tutorial-course/">
    
      <img src="/images/data-structures-must-know-algorithms-running-time-complexity-small.jpg" width="300" height="250">
      <section class="p-a-1">
        <h3>8 time complexities that every programmer should know</h3>
      </section>
    
  </a>
</article>

              <!-- </ol> -->

              
            
              

              <!-- <ol> -->
              <article class="col-md-6 col-sm-6 card">
  <a href="/Data-Structures-Time-Complexity-for-Beginners-Arrays-HashMaps-Linked-Lists-Stacks-Queues-tutorial/">
    
      <img src="/images/data-structures-time-complexity-lists-arrays-stacks-queues-hash-maps-sets-small.jpg" width="300" height="250">
      <section class="p-a-1">
        <h3>Data Structures in JavaScript: Arrays, HashMaps, and Lists</h3>
      </section>
    
  </a>
</article>

              <!-- </ol> -->

              
            
              

              <!-- <ol> -->
              <article class="col-md-6 col-sm-6 card">
  <a href="/Data-Structures-for-Beginners-Graphs-Time-Complexity-tutorial/">
    
      <img src="/images/graph-data-structures-time-complexity-small.jpg" width="300" height="250">
      <section class="p-a-1">
        <h3>Graph Data Structures in JavaScript for Beginners</h3>
      </section>
    
  </a>
</article>

              <!-- </ol> -->

              
            
              

              <!-- <ol> -->
              <article class="col-md-6 col-sm-6 card">
  <a href="/Data-Structures-for-Beginners-Trees-binary-search-tree-tutorial/">
    
      <img src="/images/data-structures-for-beginners-trees-binary-search-tree-small.jpg" width="300" height="250">
      <section class="p-a-1">
        <h3>Tree Data Structures in JavaScript for Beginners</h3>
      </section>
    
  </a>
</article>

              <!-- </ol> -->

              
            
              

              <!-- <ol> -->
              <article class="col-md-6 col-sm-6 card">
  <a href="/Self-balanced-Binary-Search-Trees-with-AVL-tree-Data-Structure-for-beginners/">
    
      <img src="/images/data-structures-algorithms-avl-binary-search-trees-small.jpg" width="300" height="250">
      <section class="p-a-1">
        <h3>Self-balanced Binary Search Trees with AVL in JavaScript</h3>
      </section>
    
  </a>
</article>

              <!-- </ol> -->

              
            
              

              <!-- <ol> -->
              <article class="col-md-6 col-sm-6 card">
  <a href="/Analysis-of-Recursive-Algorithms/">
    
      <img src="/images/data-structures-analysis-of-recursive-algorithms-small.jpg" width="300" height="250">
      <section class="p-a-1">
        <h3>Analysis of Recursive Algorithms</h3>
      </section>
    
  </a>
</article>

              <!-- </ol> -->

              
              </div><!-- .row -->
              </div><!-- .container -->
              
            
          </div>

          <!-- 726x88 -->
          <!---->
          <!--<script data-cfasync="false" type="text/javascript" src="(DISABLED)//www.eboundservices.com/ads/728x90_non_responsive.js"></script>-->
<!--           <div class="hidden-mobile-down">
            <script data-cfasync="false" type="text/javascript" src="(DISABLED)//www.eboundservices.com/ads/728x90_responsive.js"></script>
          </div> -->
          <!--<script data-cfasync="false" type="text/javascript" src="//www.eboundservices.com/ads/336x280_responsive.js"></script>-->


          <!-- last working ads -->
          <!-- <script data-cfasync="false" type="text/javascript" src="//www.eboundservices.com/ads/dfp/336x280_responsive.js"></script> -->


        </footer>

      <!-- if(page.layout !== 'snippet') -->
    </section>

    <!-- Asides (Ads, TOC, ...) -->
    <aside class="col-sm-4 p-x-2 col-xs-order-1">
      <section>

        <!-- 300x250 -->
        <!---->
        <!--<script data-cfasync="false" type="text/javascript" src="//www.eboundservices.com/ads/300x250_non_responsive.js"></script>-->
        <!--<div class="hidden-mobile-down">-->
          <!--<script data-cfasync="false" type="text/javascript" src="//www.eboundservices.com/ads/300x250_responsive.js"></script>-->
        <!--</div>-->

        <!--<div class="hidden-mobile-up">-->
        <!--<script data-cfasync="false" type="text/javascript" src="//www.eboundservices.com/ads/336x280_responsive.js"></script>-->
        <!--</div>-->

        <!-- last working ads -->
        <!-- <script data-cfasync="false" type="text/javascript" src="//www.eboundservices.com/ads/dfp/336x280_responsive.js"></script> -->

      </section>

      <section class="sticky-element--start">
        <div class="muted">
          <div class="p-y-1">
            <a href="#" class=""><span id="back-to-top" title="Go back to the top of this page">
              <i class="fa fa-arrow-up"></i> Top
            </span></a>

            <a href="#" class="p-x-3" title="Improve this post" onclick="track('https://github.com/amejiarosario/amejiarosario.github.io/edit/source/source/_posts/2018-07-28-Self-balanced-Binary-Search-Trees-with-AVL-tree-Data-Structure-for-beginners.md')">
              <i class="fa fa-pencil"></i> Edit this post
            </a>
            <!-- <a href="#" title="Share this post"><i class="fa fa-share"></i> Share</a> -->
            <!--<div class="p-y-1">-->
              <!---->
              <!---->
              <!---->
              <!---->
            <!--</div>-->
          </div>

          
            <h3 class="toc-title">Contents</h3>
            <div>
              <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Balanced-vs-Unbalanced-Binary-Search-Tree"><span class="toc-number">1.</span> <span class="toc-text">Balanced vs. Unbalanced Binary Search Tree</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#When-a-tree-is-balanced-non-balanced"><span class="toc-number">2.</span> <span class="toc-text">When a tree is balanced&#x2F;non-balanced?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Tree-rotations"><span class="toc-number">3.</span> <span class="toc-text">Tree rotations</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Left-Rotation"><span class="toc-number">3.1.</span> <span class="toc-text">Left Rotation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Right-Rotation"><span class="toc-number">3.2.</span> <span class="toc-text">Right Rotation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Left-Right-Rotation"><span class="toc-number">3.3.</span> <span class="toc-text">Left-Right Rotation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Right-Left-Rotation"><span class="toc-number">3.4.</span> <span class="toc-text">Right-Left Rotation</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AVL-Tree-Overview"><span class="toc-number">4.</span> <span class="toc-text">AVL Tree Overview</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Tree-with-one-node"><span class="toc-number">4.1.</span> <span class="toc-text">Tree with one node</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Tree-with-multiple-nodes"><span class="toc-number">4.2.</span> <span class="toc-text">Tree with multiple nodes</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AVL-Tree-Insertion-and-Deletion"><span class="toc-number">5.</span> <span class="toc-text">AVL Tree Insertion and Deletion</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Summary"><span class="toc-number">6.</span> <span class="toc-text">Summary</span></a></li></ol>
            </div>

            <!-- 300x600 -->
            <!---->
            <!--<script data-cfasync="false" type="text/javascript" src="(DISABLED)//www.eboundservices.com/ads/300x600_non_responsive.js"></script>-->
            <div class="hidden-mobile-down">
              <!-- last working ads -->
              <!-- <script data-cfasync="false" type="text/javascript" src="//www.eboundservices.com/ads/dfp/160x600_responsive.js"></script> -->

              <a href="https://books.adrianmejia.com" target="_blank">
                <!-- <img src="/images/data-structure-algorithms-javascript-presell.jpg" alt="Data Structure and Algorithms in JavaScript eBook"> -->
                <img src="/images/data-structure-algorithms-banner.jpg" alt="Data Structure and Algorithms in JavaScript eBook">
              </a>
            </div>
          
        </div>
      </section>
    </aside>
  </div>

  <!-- comments -->
  <a id="comments-section"></a>
  <footer class="row sticky-element--end">
    <div class="col-xs-12">
      <section>
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'https://adrianmejia.com/Self-balanced-Binary-Search-Trees-with-AVL-tree-Data-Structure-for-beginners/';
      this.page.identifier = 'https://adrianmejia.com/Self-balanced-Binary-Search-Trees-with-AVL-tree-Data-Structure-for-beginners/';
    };
    (function() {
      var d = document, s = d.createElement('script');
      s.src = '//adrianmejia.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a target="_blank" href="https://disqus.com/?ref_noscript" rel="nofollow noopener">comments powered by Disqus.</a></noscript>
</section>

    </div>
  </footer>
</article>

    </main>

    <!-- uxa -->
    <!-- <img src="//data.uxeranalytics.com/image1.png?uxa=blog" id="pxl1"> -->
    <!-- <script async defer src="//data.uxeranalytics.com/uxa.js"></script> -->
    <!-- /uxa -->

    <footer class="page-footer">
      <div class="container">
        <div class="p-y-2">
          &copy; 2022 <a href="http://adrianmejia.com">Adrian Mejia</a>
          <span class="muted m-x-4" title="Sat Oct 22 2022 13:43:01 GMT-0400 (Eastern Daylight Time)">
            v.rk617p
          </span>
        </div>
      </div>
    </footer>

    <!-- Scripts -->
    
<script src="/js/main.babel.js"></script>
    <script id="dsq-count-scr" src="//adrianmejia.disqus.com/count.js" async></script>
    <!-- Algolia Search -->
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/instantsearch.js/1/instantsearch.min.css" />
    <script src="//cdn.jsdelivr.net/instantsearch.js/1/instantsearch.min.js"></script>
    
<link rel="stylesheet" href="/stylesheets/55_search.css">



    <!-- social scripts -->
    <script async defer src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
    

    
      <!-- <script src="https://gumroad.com/js/gumroad.js"></script> -->

      <!-- adthis -->
      <script type="text/javascript">
        var addthis_config = {
          data_ga_property: 'UA-24183929-4',
          data_ga_social : true
        };
      </script>
      <script async defer type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-579cb31b46e2f7e6"></script>

      
<script src="/js/posts.babel.js"></script>
      
<script src="/js/posts2.babel.js"></script>
    
  </body>
</html>
