<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="author" content="Adrian Mejia">
    <link rel="author" href="humans.txt" />
    <meta name="description" content="JavaScript tutorials and web development articles including topics like NodeJS, Angular, VueJS, Data Structures and Algorithms.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">

    <link rel="alternative" href="/atom.xml" title="Adrian Mejia Blog" type="application/atom+xml">

    
    <title>Creating RESTful APIs with NodeJS and MongoDB Tutorial (Part II) | Adrian Mejia Blog</title>

    <!-- Favicons -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content="Adrian Mejia's Blog"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="/mstile-310x310.png" />
    <meta name="msapplication-notification" content="frequency=30;polling-uri=http://notifications.buildmypinnedsite.com/?feed=https://adrianmejia.com/atom.xml" />

    <link rel="canonical" href="https://adrianmejia.com/creating-a-restful-api-tutorial-with-nodejs-and-mongodb/" />
    <!-- Open Graph -->
    <meta property="og:url" content="https://adrianmejia.com/creating-a-restful-api-tutorial-with-nodejs-and-mongodb/" />
    <meta property="og:site_name" content="Adrian Mejia Blog" />
    <meta property="og:type" content="article" />
    <meta property="og:description" content="Welcome to this tutorial about RESTful API using Node.js (Express.js) and MongoDB (mongoose)! We are going to learn how to install and use each component individually and then proceed to create a RESTful API." />
    <meta property="og:image" content="https://adrianmejia.com/images/RESTfulAPIs_NodeJS__mongodb_large.png" />
    <meta property="og:title" content="Creating RESTful APIs with NodeJS and MongoDB Tutorial (Part II)" />
    <meta property="fb:app_id" content="761831487293468" />
    <meta property="fb:admins" content="895685163"/>
    <!-- /Open Graph -->

    <script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-24183929-4', 'auto');
ga('send', 'pageview');
</script><script async defer src='https://www.google-analytics.com/analytics.js'></script>


    <!-- Critical Styles -->
    <style media="screen">
      .overlay { display: none }
    </style>
    
<link rel="stylesheet" href="/stylesheets/main.css">

    <!-- loadDeferredStyles -->
    <noscript id="deferred-styles">
      
<link rel="stylesheet" href="/stylesheets/font-awesome.min.css">
    </noscript>

    <script>
      var loadDeferredStyles = function() {
        var addStylesNode = document.getElementById("deferred-styles");
        var replacement = document.createElement("div");
        replacement.innerHTML = addStylesNode.textContent;
        document.body.appendChild(replacement)
        addStylesNode.parentElement.removeChild(addStylesNode);
      };
      var raf = requestAnimationFrame || mozRequestAnimationFrame ||
          webkitRequestAnimationFrame || msRequestAnimationFrame;
      if (raf) raf(function() { window.setTimeout(loadDeferredStyles, 0); });
      else window.addEventListener('load', loadDeferredStyles);
    </script>

  <meta name="generator" content="Hexo 5.0.2"></head>
  <body>
    <header class="titlebar mdl-shadow--2dp">
      <div class="container align-center flexbox--space-between">
        <!-- <div class="row"> -->
          <!-- <div class="col-md-12"> -->
            <span class="hidden-mobile-up">
              <i class="fa fa-bars" aria-hidden="true"></i>
            </span>

            <a href="/" class="align-center m-y-2">
              <img src="/images/adrianmejia-logo.png" alt="Adrian Mejia Logo" class="animation--bounce-in"/>
              <h1 class="hidden-mobile-down hidden">
                Adrian Mejia
              </h1>
            </a>

            <nav class="hidden-mobile-down navbar">
              
                <a href="/#home" class="animation--radial-out" id="Home" onclick="track('/#home', 'menu', true)">Home</a>
              
                <a href="/#trending-posts" class="animation--radial-out" id="Trending" onclick="track('/#trending-posts', 'menu', true)">Trending</a>
              
                <a href="/#popular-posts" class="animation--radial-out" id="Popular" onclick="track('/#popular-posts', 'menu', true)">Popular</a>
              
                <a href="/#about" class="animation--radial-out" id="About" onclick="track('/#about', 'menu', true)">About</a>
              
                <a href="/blog/" class="animation--radial-out" id="Blog" onclick="track('/blog/', 'menu', true)">Blog</a>
              
            </nav>

            <a href="#" id="search-modal" onclick="track('#search', 'search', true)" class="open-overlay">
  <i class="fa fa-search" aria-hidden="true"></i>
</a>

<div id="search-overlay" class="overlay" aria-hidden="true">

  <script id="movie" type="text/x-handlebars-template">
    <article class="movie">
      {{#photos.0}}
      <a href="/{{path}}">
        <img class="movie-image" src="{{photos.0}}" />
      </a>
      {{/photos.0}}

      <div class="movie-meta">
        <div class="movie-title">
          <a href="/{{path}}">
            {{{_highlightResult.title.value}}}
          </a>
          <span class="movie-year">
            {{updatedYear}}
          </span>
        </div>

        <div class="movie-rating">
          {{#stars}}
            <span class="ais-star-rating--star{{^.}}__empty{{/.}}">
            </span>
          {{/stars}}
        </div>

        <p>
          {{{_highlightResult.excerptStrip.value}}}
        </p>

        <div class="movie-genres">
          {{#tags}}
            <div class="movie-genre">
              {{.}}
            </div>
          {{/tags}}
        </div>
      </div>
    </article>
  </script>

  <div class="search-container">

    <div class="top">
      <div class="search-button">
        <i class="fa fa-search"></i>
      </div>
      <div class="input-container">
        <input type="text" id="search-box" />
        <div id="stats"></div>
      </div>
      <a href="#" class="close-overlay">
        <i class="fa fa-times"></i>
      </a>
    </div>

    <div class="content">
      <div class="facets">

        <div class="facet">
          <div id="clear-all" class="facet-title"></div>
        </div>

        <div class="facet">
          <div class="facet-title">
            <i class="fa fa-tags" aria-hidden="true"></i> Tags
          </div>
          <div id="tags"></div>
        </div>

        <div class="facet">
          <div class="facet-title">
            <i class="fa fa-folder-o" aria-hidden="true"></i>
            Categories
          </div>
          <div id="categories"></div>
        </div>

        <div class="facet">
          <div class="facet-title">
            <i class="fa fa-eye" aria-hidden="true"></i>
            Views
          </div>
          <div id="ratings"></div>
        </div>

        <div class="facet">
          <div class="facet-title">
            <i class="fa fa-calendar" aria-hidden="true"></i>
            Year
          </div>
          <div id="year"></div>
        </div>
      </div>

      <div class="canvas">
        <div id="hits"></div>

        <div id="pagination"></div>

        <div>Powered by <img src="/images/Algolia_logo_bg-white.svg" height="30" alt="Algolia search"></div>
      </div>
    </div>
  </div>
</div>


<script src="/js/search.babel.js"></script>


      </div>
    </header>
    <nav class="hidden-mobile-up mdl-shadow--2dp">
      <div class="container flexbox--space-between navbar">
        
          <a href="/#home" class="animation--underline-from-center">Home</a>
        
          <a href="/#trending-posts" class="animation--underline-from-center">Trending</a>
        
          <a href="/#popular-posts" class="animation--underline-from-center">Popular</a>
        
          <a href="/#about" class="animation--underline-from-center">About</a>
        
          <a href="/blog/" class="animation--underline-from-center">Blog</a>
        
      </div>
    </nav>

    <main>
      <!--https://developers.google.com/search/docs/data-types/articles-->
<!--http://schema.org/BlogPosting-->
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": ""
  },
  "headline": "Creating RESTful APIs with NodeJS and MongoDB Tutorial (Part II)",
  
  "image": {
    "@type": "ImageObject",
    "url": "https://adrianmejia.com/images/RESTfulAPIs_NodeJS__mongodb_large.png",
    "height": 360,
    "width": 728
  },
  
  "datePublished": "2014-10-01T17:26:42-04:00",
  "dateModified": "2016-10-14T15:50:35-04:00",
  "author": {
    "@type": "Person",
    "name": "Adrian Mejia"
  },
   "publisher": {
    "@type": "Organization",
    "name": "Adrian Mejia",
    "logo": {
      "@type": "ImageObject",
      "url": "https://adrianmejia.com/images/logo.png",
      "width": 347,
      "height": 50
    }
  },
  "description": "Welcome to this tutorial about RESTful API using Node.js (Express.js) and MongoDB (mongoose)! We are going to learn how to install and use each component individually and then proceed to create a RESTful API."
}
</script>


<article class="container post">

  <section class="hero">
    <div class="muted">
      <a class="category-link" href="/categories/coding/">Coding</a> > <a class="category-link" href="/categories/coding/web-development/">Web Development</a> > <a class="category-link" href="/categories/coding/web-development/angular/">Angular</a>
    </div>

    <h1>Creating RESTful APIs with NodeJS and MongoDB Tutorial (Part II)</h1>

    <div class="muted">
      <span title="Last time this post was updated">
        <i class="fa fa-calendar" aria-hidden="true"></i>
        Last updated
        <time datetime="2016-10-14T19:50:35.000Z" itemprop="dateUpdated">October 14th 2016</time>
      </span>

      
        <span class="m-x-2" title="Pageviews">
          <i class="fa fa-eye" aria-hidden="true"></i>
          574.4k
        </span>
      

      <span class="m-x-2" title="Click to go to the comments section">
        <a href="#disqus_thread">
          <i class="fa fa-comment-o" aria-hidden="true"></i>
          <span class="disqus-comment-count" data-disqus-url="https://adrianmejia.com/creating-a-restful-api-tutorial-with-nodejs-and-mongodb/">0</span>
        </a>
      </span>

      
        <span>
          <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/express/" rel="tag">express</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/" rel="tag">mongodb</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nodejs/" rel="tag">nodejs</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tutorial-mean-stack/" rel="tag">tutorial_mean-stack</a><span class="tag-list-count">3</span></li></ul>
        </span>
      
    </div>
  </section>

  <div class="art-container" style="background-color: #4C4D4E">
    
      <picture>
        <source media="(min-width: 728px)" srcset="/images/RESTfulAPIs_NodeJS__mongodb_large.png">
        <source srcset="/images/RESTfulAPIs_NodeJS__mongodb_small.png">
        <img src="/images/RESTfulAPIs_NodeJS__mongodb_large.png" alt="Creating RESTful APIs with NodeJS and MongoDB Tutorial (Part II)">
      </picture>
    
  </div>

  <div class="row">
    <section class="col-sm-8 p-x-2">

      <div class="post-content  toc-content ">
        <p>Welcome to this tutorial about RESTful API using Node.js (Express.js) and MongoDB (mongoose)! We are going to learn how to install and use each component individually and then proceed to create a RESTful API.</p>
<a id="more"></a>

<blockquote>
<p>Check out the updated version of this post with Angular 9+, Node.js 12+ in here: <a href="/angular-todo-mean-stack-node-mongodb-typescript-tutorial/">Modern MEAN Stack Tutorial with Docker</a></p>
</blockquote>
<p>MEAN Stack tutorial series:</p>
<ol>
<li><a href="/blog/2014/09/28/angularjs-tutorial-for-beginners-with-nodejs-expressjs-and-mongodb/">AngularJS tutorial for beginners (Part I)</a></li>
<li>Creating RESTful APIs with NodeJS and MongoDB Tutorial (Part II) <strong>ðŸ‘ˆ you are here</strong></li>
<li><a href="/blog/2014/10/03/mean-stack-tutorial-mongodb-expressjs-angularjs-nodejs/">MEAN Stack Tutorial: MongoDB, ExpressJS, AngularJS and NodeJS (Part III)</a></li>
</ol>
<h2 id="What-is-a-RESTful-API"><a href="#What-is-a-RESTful-API" class="headerlink" title="What is a RESTful API?"></a>What is a RESTful API?</h2><p>REST stands for Representational State Transfer. It is an architecture that allows <code>client-server</code> communication through a uniform interface. REST is <code>stateless</code>, <code>cachable</code> and has property called <code>idempotence</code>. It means that the side effect of identical requests have the same side-effect as a single request.</p>
<p>HTTP RESTful APIâ€™s are compose of:</p>
<ul>
<li>HTTP methods, e.g. GET, PUT, DELETE, PATCH, POST, â€¦</li>
<li>Base URI, e.g. <code>http://adrianmejia.com</code></li>
<li>URL path, e.g. <code>/blog/2014/10/01/creating-a-restful-api-tutorial-with-nodejs-and-mongodb/</code></li>
<li>Media type, e.g. <code>html</code>, <code>JSON</code>, <code>XML</code>, <code>Microformats</code>, <code>Atom</code>, <code>Images</code>â€¦</li>
</ul>
<p>Here is a summary what we want to implement:</p>
<table>
<thead>
<tr>
<th>Resource (URI)</th>
<th>POST (create)</th>
<th>GET (read)</th>
<th>PUT (update)</th>
<th>DELETE (destroy)</th>
</tr>
</thead>
<tbody><tr>
<td>/todos</td>
<td>create new task</td>
<td>list tasks</td>
<td>N/A (update all)</td>
<td>N/A (destroy all)</td>
</tr>
<tr>
<td>/todos/1</td>
<td>error</td>
<td>show task ID 1</td>
<td>update task ID 1</td>
<td>destroy task ID 1</td>
</tr>
</tbody></table>
<p><strong>NOTE</strong> for this tutorial:</p>
<ul>
<li>Format will be JSON.</li>
<li>Bulk updates and bulk destroys are not safe, so we will not be implementing those.</li>
<li><strong>CRUD</strong> functionality: POST == <strong>C</strong>REATE, GET == <strong>R</strong>EAD, PUT == <strong>U</strong>PDATE, DELETE == <strong>D</strong>ELETE.</li>
</ul>
<h2 id="Installing-the-MEAN-Stack-Backend"><a href="#Installing-the-MEAN-Stack-Backend" class="headerlink" title="Installing the MEAN Stack Backend"></a>Installing the MEAN Stack Backend</h2><p>In this section, we are going to install the backend components of the MEAN stack: MongoDB, NodeJS and ExpressJS. If you already are familiar with them, then jump to <a href="#wiring-up-the-mean-stack">wiring the stack</a>. Otherwise, enjoy the ride!</p>
<h3 id="Installing-MongoDB"><a href="#Installing-MongoDB" class="headerlink" title="Installing MongoDB"></a>Installing MongoDB</h3><p>MongoDB is a document-oriented NoSQL database (Big Data ready). It stores data in JSON-like format and allows users to perform SQL-like queries against it.</p>
<p>You can install MongoDB following the <a href="http://docs.mongodb.org/manual/installation/" target="_blank">instructions here</a>.</p>
<p>If you have a <strong>Mac</strong> and <a href="http://brew.sh/" target="_blank">brew</a> itâ€™s just:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install mongodb &amp;&amp; mongod</span><br></pre></td></tr></table></figure>

<p>In <strong>Ubuntu</strong>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get -y install mongodb</span><br></pre></td></tr></table></figure>


<p>After you have them installed, check version as follows:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Mac</span></span><br><span class="line">mongod --version</span><br><span class="line"><span class="comment">## =&gt; db version v2.6.4</span></span><br><span class="line"><span class="comment">## =&gt; 2014-10-01T19:07:26.649-0400 git version: nogitversion</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Ubuntu</span></span><br><span class="line">mongod --version</span><br><span class="line"><span class="comment">## =&gt; db version v2.0.4, pdfile version 4.5</span></span><br><span class="line"><span class="comment">## =&gt; Wed Oct  1 23:06:54 git version: nogitversion</span></span><br></pre></td></tr></table></figure>

<h3 id="Installing-NodeJS"><a href="#Installing-NodeJS" class="headerlink" title="Installing NodeJS"></a>Installing NodeJS</h3><p>The Node official definition is:</p>
<blockquote><p>Node.jsÂ® is a JavaScript runtime built on Chromeâ€™s V8 JavaScript engine. Node.js uses an event-driven, non-blocking I/O model that makes it lightweight and efficient. Node.jsâ€™ package ecosystem, npm, is the largest ecosystem of open source libraries in the world.</p>
<footer><strong>Node.js Website</strong><cite><a target="_blank" rel="noopener" href="https://nodejs.org">nodejs.org</a></cite></footer></blockquote>

<p>In short, NodeJS allows you to run Javascript outside the browser, in this case, on the web server. <abbr title="Node Package Manager">NPM</abbr> allows you to install/publish node packages with ease.</p>
<p>To install it, you can go to the <a href="http://nodejs.org/" target="_blank">NodeJS Website</a>.</p>
<p>Since Node versions changes very often. You can use the <abbr title="Node Version Manager">NVM</abbr> (Node Version Manager) on <strong>Ubuntu</strong> and Mac with:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## download NPM</span></span><br><span class="line">curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.4/install.sh | bash</span><br><span class="line"></span><br><span class="line"><span class="comment">## load NPM</span></span><br><span class="line"><span class="built_in">export</span> NVM_DIR=<span class="string">&quot;<span class="variable">$HOME</span>/.nvm&quot;</span></span><br><span class="line">[ -s <span class="string">&quot;<span class="variable">$NVM_DIR</span>/nvm.sh&quot;</span> ] &amp;&amp; . <span class="string">&quot;<span class="variable">$NVM_DIR</span>/nvm.sh&quot;</span> <span class="comment"># This loads nvm</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Install latest stable version</span></span><br><span class="line">nvm install stable</span><br></pre></td></tr></table></figure>

<p>Check out <a href="https://github.com/creationix/nvm" target="_blank">https://github.com/creationix/nvm</a> for more details.</p>
<p>Also, on <strong>Mac</strong> and <a href="http://brew.sh" target="_blank">brew</a> you can do:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install nodejs</span><br></pre></td></tr></table></figure>


<p>After you got it installed, check node version and npm (node package manager) version:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br><span class="line"><span class="comment">## =&gt; v6.2.2</span></span><br><span class="line"></span><br><span class="line">npm -v</span><br><span class="line"><span class="comment">## =&gt; 3.9.5</span></span><br></pre></td></tr></table></figure>

<h3 id="Installing-ExpressJS"><a href="#Installing-ExpressJS" class="headerlink" title="Installing ExpressJS"></a>Installing ExpressJS</h3><p>ExpressJS is a web application framework that runs on NodeJS. It allows you to build web applications and API endpoints. (more details on this later).</p>
<p>We are going to create a project folder first, and then add <code>express</code> as a dependency.
Letâ€™s use <abbr title="Node Package Manager">NPM</abbr> init command to get us started.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## create project folder</span></span><br><span class="line">mkdir todo-app</span><br><span class="line"></span><br><span class="line"><span class="comment">## move to the folder and initialize the project</span></span><br><span class="line"><span class="built_in">cd</span> todo-app</span><br><span class="line">npm init .  <span class="comment"># press enter multiple times to accept all defaults</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## install express v4.14 and save it as dependency</span></span><br><span class="line">npm install express@4.14 --save</span><br></pre></td></tr></table></figure>

<p>Notice that after the last command, <code>express</code> should be added to package.json with the version <code>4.14.x</code>.</p>
<h2 id="Using-MongoDB-with-Mongoose"><a href="#Using-MongoDB-with-Mongoose" class="headerlink" title="Using MongoDB with Mongoose"></a>Using MongoDB with Mongoose</h2><p>Mongoose is an <abbr title="Node Package Manager">NPM</abbr> package that allows you to interact with MongoDB. You can install it as follows:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mongoose@4.5.8 --save</span><br></pre></td></tr></table></figure>

<p>If you followed the previous steps, you should have all you need to complete this tutorial. We are going to build an API that allow users to CRUD (Create-Read-Update-Delete) Todo tasks from database.</p>
<h3 id="Mongoose-CRUD"><a href="#Mongoose-CRUD" class="headerlink" title="Mongoose CRUD"></a>Mongoose CRUD</h3><p>CRUD == <strong>C</strong>reate-<strong>R</strong>ead-<strong>U</strong>pdate-<strong>D</strong>elete</p>
<p>We are going to create, read, update and delete data from MongoDB using Mongoose/Node. First, you need to have mongodb up and running:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## run mongo daemon</span></span><br><span class="line">mongod</span><br></pre></td></tr></table></figure>

<p>Keep mongo running in a terminal window and while in the folder <code>todoApp</code> type <code>node</code> to enter the node CLI. Then:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Load mongoose package</span></span><br><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">&#x27;mongoose&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Connect to MongoDB and create/use database called todoAppTest</span></span><br><span class="line">mongoose.connect(<span class="string">&#x27;mongodb://localhost/todoAppTest&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create a schema</span></span><br><span class="line"><span class="keyword">var</span> TodoSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">  name: <span class="built_in">String</span>,</span><br><span class="line">  completed: <span class="built_in">Boolean</span>,</span><br><span class="line">  note: <span class="built_in">String</span>,</span><br><span class="line">  updated_at: &#123; <span class="attr">type</span>: <span class="built_in">Date</span>, <span class="attr">default</span>: <span class="built_in">Date</span>.now &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create a model based on the schema</span></span><br><span class="line"><span class="keyword">var</span> Todo = mongoose.model(<span class="string">&#x27;Todo&#x27;</span>, TodoSchema);</span><br></pre></td></tr></table></figure>

<p>Great! Now, letâ€™s test that we can save and edit data.</p>
<h3 id="Mongoose-Create"><a href="#Mongoose-Create" class="headerlink" title="Mongoose Create"></a>Mongoose Create</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// Create a todo in memory</span></span><br><span class="line"><span class="keyword">var</span> todo = <span class="keyword">new</span> Todo(&#123;<span class="attr">name</span>: <span class="string">&#x27;Master NodeJS&#x27;</span>, <span class="attr">completed</span>: <span class="literal">false</span>, <span class="attr">note</span>: <span class="string">&#x27;Getting there...&#x27;</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Save it to database</span></span><br><span class="line">todo.save(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(err)</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">console</span>.log(todo);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>If you take a look to Mongo you will notice that we just created an entry. You can easily visualize data using <a href="https://robomongo.org/" target="_blank">Robomongo</a>:</p>
<img src="https://i.imgur.com/DI6Vxwq.png" class="" title="Viewing data with Robomongo">

<p>You can also build the object and save it in one step using <code>create</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Todo.create(&#123;<span class="attr">name</span>: <span class="string">&#x27;Create something with Mongoose&#x27;</span>, <span class="attr">completed</span>: <span class="literal">true</span>, <span class="attr">note</span>: <span class="string">&#x27;this is one&#x27;</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err, todo</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(err) <span class="built_in">console</span>.log(err);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">console</span>.log(todo);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Mongoose-Read-and-Query"><a href="#Mongoose-Read-and-Query" class="headerlink" title="Mongoose Read and Query"></a>Mongoose Read and Query</h3><p>So far we have been able to save data, now we are going explore how to query the information.
There are multiple options for reading/querying data:</p>
<ul>
<li>Model.find(conditions, [fields], [options], [callback])</li>
<li>Model.findById(id, [fields], [options], [callback])</li>
<li>Model.findOne(conditions, [fields], [options], [callback])</li>
</ul>
<p>Some examples:</p>
<figure class="highlight javascript"><figcaption><span>Find all</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Find all data in the Todo collection</span></span><br><span class="line">Todo.find(<span class="function"><span class="keyword">function</span> (<span class="params">err, todos</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="built_in">console</span>.error(err);</span><br><span class="line">  <span class="built_in">console</span>.log(todos)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>The result is something like this:</p>
<figure class="highlight plain"><figcaption><span>results</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[ &#123; _id: 57a6116427f107adef36c2f2,</span><br><span class="line">    name: &#39;Master NodeJS&#39;,</span><br><span class="line">    completed: false,</span><br><span class="line">    note: &#39;Getting there...&#39;,</span><br><span class="line">    __v: 0,</span><br><span class="line">    updated_at: 2016-08-06T16:33:40.606Z &#125;,</span><br><span class="line">  &#123; _id: 57a6142127f107adef36c2f3,</span><br><span class="line">    name: &#39;Create something with Mongoose&#39;,</span><br><span class="line">    completed: true,</span><br><span class="line">    note: &#39;this is one&#39;,</span><br><span class="line">    __v: 0,</span><br><span class="line">    updated_at: 2016-08-06T16:45:21.143Z &#125; ]</span><br></pre></td></tr></table></figure>

<p>You can also add queries</p>
<figure class="highlight javascript"><figcaption><span>Find with queries</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// callback function to avoid duplicating it all over</span></span><br><span class="line"><span class="keyword">var</span> callback = <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123; <span class="keyword">return</span> <span class="built_in">console</span>.error(err); &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123; <span class="built_in">console</span>.log(data); &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get ONLY completed tasks</span></span><br><span class="line">Todo.find(&#123;<span class="attr">completed</span>: <span class="literal">true</span> &#125;, callback);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get all tasks ending with `JS`</span></span><br><span class="line">Todo.find(&#123;<span class="attr">name</span>: <span class="regexp">/JS$/</span> &#125;, callback);</span><br></pre></td></tr></table></figure>

<p>You can chain multiple queries, e.g.:</p>
<figure class="highlight javascript"><figcaption><span>Chaining queries</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> oneYearAgo = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">oneYearAgo.setYear(oneYearAgo.getFullYear() - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get all tasks staring with `Master`, completed</span></span><br><span class="line">Todo.find(&#123;<span class="attr">name</span>: <span class="regexp">/^Master/</span>, completed: <span class="literal">true</span> &#125;, callback);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get all tasks staring with `Master`, not completed and created from year ago to now...</span></span><br><span class="line">Todo.find(&#123;<span class="attr">name</span>: <span class="regexp">/^Master/</span>, completed: <span class="literal">false</span> &#125;).where(<span class="string">&#x27;updated_at&#x27;</span>).gt(oneYearAgo).exec(callback);</span><br></pre></td></tr></table></figure>

<p>MongoDB query language is very powerful. We can combine regular expressions, date comparison and more!</p>
<h3 id="Mongoose-Update"><a href="#Mongoose-Update" class="headerlink" title="Mongoose Update"></a>Mongoose Update</h3><p>Moving on, we are now going to explore how to update data.</p>
<p>Each model has an <code>update</code> method which accepts multiple updates (for batch updates, because it doesnâ€™t return an array with data).</p>
<ul>
<li>Model.update(conditions, update, [options], [callback])</li>
<li>Model.findByIdAndUpdate(id, [update], [options], [callback])</li>
<li>Model.findOneAndUpdate([conditions], [update], [options], [callback])</li>
</ul>
<p>Alternatively, the method <code>findOneAndUpdate</code> could be used to update just one and return an object.</p>
<figure class="highlight javascript"><figcaption><span>Todo.update and Todo.findOneAndUpdate</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// Model.update(conditions, update, [options], [callback])</span></span><br><span class="line"><span class="comment">// update `multi`ple tasks from complete false to true</span></span><br><span class="line"></span><br><span class="line">Todo.update(&#123; <span class="attr">name</span>: <span class="regexp">/master/i</span> &#125;, &#123; <span class="attr">completed</span>: <span class="literal">true</span> &#125;, &#123; <span class="attr">multi</span>: <span class="literal">true</span> &#125;, callback);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Model.findOneAndUpdate([conditions], [update], [options], [callback])</span></span><br><span class="line">Todo.findOneAndUpdate(&#123;<span class="attr">name</span>: <span class="regexp">/JS$/</span> &#125;, &#123;<span class="attr">completed</span>: <span class="literal">false</span>&#125;, callback);</span><br></pre></td></tr></table></figure>

<p>As you might noticed the batch updates (<code>multi: true</code>) doesnâ€™t show the data, rather shows the number of fields that were modified.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="attr">ok</span>: <span class="number">1</span>, <span class="attr">nModified</span>: <span class="number">1</span>, <span class="attr">n</span>: <span class="number">1</span> &#125;</span><br></pre></td></tr></table></figure>

<p>Here is what they mean:</p>
<ul>
<li><code>n</code> means the number of records that matches the query</li>
<li><code>nModified</code> represents the number of documents that were modified with update query.</li>
</ul>
<h3 id="Mongoose-Delete"><a href="#Mongoose-Delete" class="headerlink" title="Mongoose Delete"></a>Mongoose Delete</h3><p><code>update</code> and <code>remove</code> mongoose API are identical, the only difference it is that no elements are returned. Try it on your own ;)</p>
<ul>
<li>Model.remove(conditions, [callback])</li>
<li>Model.findByIdAndRemove(id, [options], [callback])</li>
<li>Model.findOneAndRemove(conditions, [options], [callback])</li>
</ul>
<h2 id="ExpressJS-and-Middlewares"><a href="#ExpressJS-and-Middlewares" class="headerlink" title="ExpressJS and Middlewares"></a>ExpressJS and Middlewares</h2><p>ExpressJS is a complete web framework solution. It has HTML template solutions (jade, ejs, handlebars, hogan.js) and CSS precompilers (less, stylus, compass). Through middlewares layers, it handles: cookies, sessions, caching, CSRF, compression and many more.</p>
<p><strong>Middlewares</strong> are pluggable processors that runs on each request made to the server. You can have any number of middlewares that will process the request one by one in a serial fashion. Some middlewares might alter the request input. Others, might create log outputs, add data and pass it to the <code>next()</code> middleware in the chain.</p>
<p>We can use the middlewares using <code>app.use</code>. That will apply for all request. If you want to be more specific, you can use <code>app.verb</code>. For instance: app.get, app.delete, app.post, app.update, â€¦</p>
<p><img src="/images/express-middlewares.png" alt="ExpressJS Middlewares"></p>
<p>Letâ€™s give some examples of middlewares to drive the point home.</p>
<p>Say you want to log the IP of the client on each request:</p>
<figure class="highlight javascript"><figcaption><span>Log the client IP on every request</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> ip = req.headers[<span class="string">&#x27;x-forwarded-for&#x27;</span>] || req.connection.remoteAddress;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;Client IP:&#x27;</span>, ip);</span><br><span class="line">  next();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Notice that each middleware has 3 parameters:</p>
<ul>
<li><code>req</code>: contain all the requests objects like URLs, path, â€¦</li>
<li><code>res</code>: is the response object where we can send the reply back to the client.</li>
<li><code>next</code>: continue with the next middleware in the chain.</li>
</ul>
<p>You can also specify a path that you want the middleware to activate on.</p>
<figure class="highlight javascript"><figcaption><span>Middleware mounted on "/todos/:id" and log the request method</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="string">&#x27;/todos/:id&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;Request Type:&#x27;</span>, req.method);</span><br><span class="line">  next();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>And finally you can use <code>app.get</code> to catch GET requests with matching routes, reply the request with a <code>response.send</code> and end the middleware chain. Letâ€™s use what we learned on <a href="#mongoose-read-and-query">mongoose read</a> to reply with the userâ€™s data that matches the <code>id</code>.</p>
<figure class="highlight javascript"><figcaption><span>Middleware mounted on "/todos/:id" and returns</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.get(<span class="string">&#x27;/todos/:id&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  Todo.findById(req.params.id, <span class="function"><span class="keyword">function</span>(<span class="params">err, todo</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(err) res.send(err);</span><br><span class="line">    res.json(todo);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Notice that all previous middlewares called <code>next()</code> except this last one, because it sends a response (in JSON) to the client with the requested <code>todo</code> data.</p>
<p>Hopefully, you donâ€™t have to develop a bunch of middlewares besides routes, since ExpressJS has a bunch of middlewares available.</p>
<h3 id="Default-Express-4-0-middlewares"><a href="#Default-Express-4-0-middlewares" class="headerlink" title="Default Express 4.0 middlewares"></a>Default Express 4.0 middlewares</h3><ul>
<li><p><a href="https://github.com/expressjs/morgan" target="_blank">morgan</a>: logger</p>
</li>
<li><p><a href="https://github.com/expressjs/body-parser" target="_blank">body-parser</a>: parse the body so you can access parameters in requests in <code>req.body</code>. e.g. <code>req.body.name</code>.</p>
</li>
<li><p><a href="https://github.com/expressjs/cookie-parser" target="_blank">cookie-parser</a>: parse the cookies so you can access parameters in cookies <code>req.cookies</code>. e.g. <code>req.cookies.name</code>.</p>
</li>
<li><p><a href="https://github.com/expressjs/serve-favicon" target="_blank">serve-favicon</a>: exactly that, serve favicon from route <code>/favicon.ico</code>. Should be call on the top before any other routing/middleware takes place to avoids unnecessary parsing.</p>
</li>
</ul>
<h3 id="Other-ExpressJS-Middlewares"><a href="#Other-ExpressJS-Middlewares" class="headerlink" title="Other ExpressJS Middlewares"></a>Other ExpressJS Middlewares</h3><p>The following middlewares are not added by default, but itâ€™s nice to know they exist at least:</p>
<ul>
<li><p><a href="https://github.com/expressjs/compression" target="_blank">compression</a>: compress all request. e.g. <code>app.use(compression())</code></p>
</li>
<li><p><a href="https://github.com/expressjs/session" target="_blank">session</a>: create sessions. e.g. <code>app.use(session(&#123;secret: &#39;Secr3t&#39;&#125;))</code></p>
</li>
<li><p><a href="https://github.com/expressjs/method-override" target="_blank">method-override</a>: <code>app.use(methodOverride(&#39;_method&#39;))</code> Override methods to the one specified on the <code>_method</code> param. e.g. <code>GET /resource/1?_method=DELETE</code> will become <code>DELETE /resource/1</code>.</p>
</li>
<li><p><a href="https://github.com/expressjs/response-time" target="_blank">response-time</a>: <code>app.use(responseTime())</code> adds <code>X-Response-Time</code> header to responses.</p>
</li>
<li><p><a href="https://github.com/expressjs/errorhandler" target="_blank">errorhandler</a>: Aid development, by sending full error stack traces to the client when an error occurs. <code>app.use(errorhandler())</code>. It is good practice to surround it with an if statement to check <code>process.env.NODE_ENV === &#39;development&#39;</code>.</p>
</li>
<li><p><a href="https://github.com/expressjs/vhost" target="_blank">vhost</a>: Allows you to use different stack of middlewares depending on the request <code>hostname</code>. e.g. <code>app.use(vhost(&#39;*.user.local&#39;, userapp))</code> and <code>app.use(vhost(&#39;assets-*.example.com&#39;, staticapp))</code> where <code>userapp</code> and <code>staticapp</code> are different express instances with different middlewares.</p>
</li>
<li><p><a href="https://github.com/expressjs/csurf" target="_blank">csurf</a>: Adds a <strong>C</strong>ross-<strong>s</strong>ite <strong>r</strong>equest <strong>f</strong>orgery (CSRF) protection by adding a token to responds either via <code>session</code> or <code>cookie-parser</code> middleware. <code>app.use(csrf());</code></p>
</li>
<li><p><a href="https://github.com/expressjs/timeout" target="_blank">timeout</a>: halt execution if it takes more that a given time. e.g. <code>app.use(timeout(&#39;5s&#39;));</code>. However you need to check by yourself under every request with a middleware that checks <code>if (!req.timedout) next();</code>.</p>
</li>
</ul>
<h2 id="Wiring-up-the-MEAN-Stack"><a href="#Wiring-up-the-MEAN-Stack" class="headerlink" title="Wiring up the MEAN Stack"></a>Wiring up the MEAN Stack</h2><p>In the next sections, we are going to put together everything that we learn from and build an API. They can be consume by browsers, mobile apps and even other servers.</p>
<img src="/images/api_uses.png" class="" title="API Consumers">

<h3 id="Bootstrapping-ExpressJS"><a href="#Bootstrapping-ExpressJS" class="headerlink" title="Bootstrapping ExpressJS"></a>Bootstrapping ExpressJS</h3><p>After a detour in the land of Node, MongoDB, Mongoose, and middlewares, we are back to our express todoApp. This time to create the routes and finalize our RESTful API.</p>
<p>Express has a separate package called <code>express-generator</code>, which can help us to get started with out API.</p>
<figure class="highlight bash"><figcaption><span>Install and run "express-generator"</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## install it globally using -g</span></span><br><span class="line">npm install express-generator -g</span><br><span class="line"></span><br><span class="line"><span class="comment">## create todo-app API with EJS views (instead the default Jade)</span></span><br><span class="line">express todo-api -e</span><br><span class="line"></span><br><span class="line"><span class="comment">##   create : todo-api</span></span><br><span class="line"><span class="comment">##   create : todo-api/package.json</span></span><br><span class="line"><span class="comment">##   create : todo-api/app.js</span></span><br><span class="line"><span class="comment">##   create : todo-api/public</span></span><br><span class="line"><span class="comment">##   create : todo-api/public/javascripts</span></span><br><span class="line"><span class="comment">##   create : todo-api/routes</span></span><br><span class="line"><span class="comment">##   create : todo-api/routes/index.js</span></span><br><span class="line"><span class="comment">##   create : todo-api/routes/users.js</span></span><br><span class="line"><span class="comment">##   create : todo-api/public/stylesheets</span></span><br><span class="line"><span class="comment">##   create : todo-api/public/stylesheets/style.css</span></span><br><span class="line"><span class="comment">##   create : todo-api/views</span></span><br><span class="line"><span class="comment">##   create : todo-api/views/index.ejs</span></span><br><span class="line"><span class="comment">##   create : todo-api/views/layout.ejs</span></span><br><span class="line"><span class="comment">##   create : todo-api/views/error.ejs</span></span><br><span class="line"><span class="comment">##   create : todo-api/public/images</span></span><br><span class="line"><span class="comment">##   create : todo-api/bin</span></span><br><span class="line"><span class="comment">##   create : todo-api/bin/www</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">##   install dependencies:</span></span><br><span class="line"><span class="comment">##     $ cd todo-api &amp;&amp; npm install</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">##   run the app on Linux/Mac:</span></span><br><span class="line"><span class="comment">##     $ DEBUG=todo-app:* npm start</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">##   run the app on Windows:</span></span><br><span class="line"><span class="comment">##     $ SET DEBUG=todo-api:* &amp; npm start</span></span><br></pre></td></tr></table></figure>

<p>This will create a new folder called <code>todo-api</code>. Letâ€™s go ahead and install the dependencies and run the app:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## install dependencies</span></span><br><span class="line"><span class="built_in">cd</span> todo-api &amp;&amp; npm install</span><br><span class="line"></span><br><span class="line"><span class="comment">## run the app on Linux/Mac</span></span><br><span class="line">PORT=4000 npm start</span><br><span class="line"></span><br><span class="line"><span class="comment">## run the app on Windows</span></span><br><span class="line">SET PORT=4000 &amp; npm start</span><br></pre></td></tr></table></figure>


<p>Use your browser to go to <a target="_blank" rel="noopener" href="http://0.0.0.0:4000/">http://0.0.0.0:4000</a>, and you should see a message â€œWelcome to Expressâ€</p>
<h3 id="Connect-ExpressJS-to-MongoDB"><a href="#Connect-ExpressJS-to-MongoDB" class="headerlink" title="Connect ExpressJS to MongoDB"></a>Connect ExpressJS to MongoDB</h3><p>In this section we are going to access MongoDB using our newly created express app. Hopefully, you have installed MongoDB in the <a href="#mongodb">setup section</a>, and you can start it by typing (if you havenâ€™t yet):</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongod</span><br></pre></td></tr></table></figure>

<p>Install the MongoDB driver for NodeJS called mongoose:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mongoose --save</span><br></pre></td></tr></table></figure>

<p>Notice <code>--save</code>. It will add it to the <code>todo-api/package.json</code></p>
<p>Next, you need to require mongoose in the <code>todo-api/app.js</code></p>
<figure class="highlight javascript"><figcaption><span>Add to app.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// load mongoose package</span></span><br><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">&#x27;mongoose&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Use native Node promises</span></span><br><span class="line">mongoose.Promise = <span class="built_in">global</span>.Promise;</span><br><span class="line"></span><br><span class="line"><span class="comment">// connect to MongoDB</span></span><br><span class="line">mongoose.connect(<span class="string">&#x27;mongodb://localhost/todo-api&#x27;</span>)</span><br><span class="line">  .then(<span class="function">() =&gt;</span>  <span class="built_in">console</span>.log(<span class="string">&#x27;connection succesful&#x27;</span>))</span><br><span class="line">  .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> <span class="built_in">console</span>.error(err));</span><br></pre></td></tr></table></figure>

<p>Now, When you run <code>npm start</code> or <code>./bin/www</code>, you will notice the message <code>connection successful</code>. Great!</p>
<p>You can find the repository <a target="_blank" rel="noopener" href="https://github.com/amejiarosario/todoAPIjs">here</a> and the diff code at this point:
<a target="_blank" rel="noopener" href="https://github.com/amejiarosario/todoAPIjs/commit/948a32391d208dd1303d67b443456a377e93fb8d">diff</a></p>
<h3 id="Creating-the-Todo-model-with-Mongoose"><a href="#Creating-the-Todo-model-with-Mongoose" class="headerlink" title="Creating the Todo model with Mongoose"></a>Creating the Todo model with Mongoose</h3><p>Itâ€™s show time! All the above was setup and preparation for this moment. Let bring the API to life.</p>
<p>Create a <code>models</code> directory and a <code>Todo.js</code> model:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir models</span><br><span class="line">touch models/Todo.js</span><br></pre></td></tr></table></figure>

<p>In the <code>models/Todo.js</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">&#x27;mongoose&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> TodoSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">  name: <span class="built_in">String</span>,</span><br><span class="line">  completed: <span class="built_in">Boolean</span>,</span><br><span class="line">  note: <span class="built_in">String</span>,</span><br><span class="line">  updated_at: &#123; <span class="attr">type</span>: <span class="built_in">Date</span>, <span class="attr">default</span>: <span class="built_in">Date</span>.now &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = mongoose.model(<span class="string">&#x27;Todo&#x27;</span>, TodoSchema);</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/amejiarosario/todoAPIjs/commit/afc908027339b22f10de3b77518ac0728668d470">diff</a></p>
<p>Whatâ€™s going on up there? Isnâ€™t MongoDB suppose to be schemaless? Well, it is schemaless and very flexible indeed. However, very often we want bring sanity to our API/WebApp through validations and enforcing a schema to keep a consistent structure. Mongoose does that for us, which is nice.</p>
<p>You can use the following types:</p>
<ul>
<li>String</li>
<li>Boolean</li>
<li>Date</li>
<li>Array</li>
<li>Number</li>
<li>ObjectId</li>
<li>Mixed</li>
<li>Buffer</li>
</ul>
<h2 id="API-clients-Browser-Postman-and-curl"><a href="#API-clients-Browser-Postman-and-curl" class="headerlink" title="API clients (Browser, Postman and curl)"></a>API clients (Browser, Postman and curl)</h2><p>I know you have not created any route yet. However, in the next sections you will. These are just three ways to retrieve, change and delete data from your future API.</p>
<h3 id="Curl"><a href="#Curl" class="headerlink" title="Curl"></a>Curl</h3><figure class="highlight bash"><figcaption><span>Create tasks</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Create task</span></span><br><span class="line">curl -XPOST http://localhost:3000/todos -d <span class="string">&#x27;name=Master%20Routes&amp;completed=false&amp;note=soon...&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## List tasks</span></span><br><span class="line">curl -XGET http://localhost:3000/todos</span><br></pre></td></tr></table></figure>

<h3 id="Browser-and-Postman"><a href="#Browser-and-Postman" class="headerlink" title="Browser and Postman"></a>Browser and Postman</h3><p>If you open your browser and type <code>localhost:3000/todos</code> you will see all the tasks (when you implement it). However, you cannot do post commands by default. For further testing letâ€™s use a Chrome plugin called <a href="https://chrome.google.com/webstore/detail/postman-rest-client/fdmmgilgnpjigdojojpjoooidkmcomcm?hl=en" target="_blank">Postman</a>. It allows you to use all the HTTP VERBS easily and check <code>x-www-form-urlencoded</code> for adding parameters.</p>
<img src="/images/postman_post.png" class="" title="Postman POST example">

<blockquote>
<p>Donâ€™t forget to check <code>x-www-form-urlencoded</code> or it wonâ€™t work ;)</p>
</blockquote>
<h3 id="Websites-and-Mobile-Apps"><a href="#Websites-and-Mobile-Apps" class="headerlink" title="Websites and Mobile Apps"></a>Websites and Mobile Apps</h3><p>Probably these are the main consumers of APIs. You can interact with RESTful APIs using jQueryâ€™s <code>$ajax</code> and its wrappers, BackboneJSâ€™s Collections/models, AngularJSâ€™s <code>$http</code> or <code>$resource</code>, among many other libraries/frameworks and mobile clients.</p>
<p>In the end, we are going to explain how to use AngularJS to interact with this API.</p>
<h2 id="ExpressJS-Routes"><a href="#ExpressJS-Routes" class="headerlink" title="ExpressJS Routes"></a>ExpressJS Routes</h2><p>To sum up we want to achieve the following:</p>
<table>
<thead>
<tr>
<th>Resource (URI)</th>
<th>POST (create)</th>
<th>GET (read)</th>
<th>PUT (update)</th>
<th>DELETE (destroy)</th>
</tr>
</thead>
<tbody><tr>
<td>/todos</td>
<td>create new task</td>
<td>list tasks</td>
<td>error</td>
<td>error</td>
</tr>
<tr>
<td>/todos/:id</td>
<td>error</td>
<td>show task :id</td>
<td>update task :id</td>
<td>destroy task ID 1</td>
</tr>
</tbody></table>
<p>Letâ€™s setup the routes</p>
<p>```bash Create a new route called <code>todos.js</code> in the <code>routes</code> folder or rename <code>users.js</code>
mv routes/users.js routes/todos.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">In &#96;app.js&#96; add new &#96;todos&#96; route, or just replace &#96;.&#x2F;routes&#x2F;users&#96; for &#96;.&#x2F;routes&#x2F;todos&#96;</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96; javascript Adding todos routes</span><br><span class="line">var todos &#x3D; require(&#39;.&#x2F;routes&#x2F;todos&#39;);</span><br><span class="line">app.use(&#39;&#x2F;todos&#39;, todos);</span><br></pre></td></tr></table></figure>

<p>All set! Now, letâ€™s go back and edit our <code>routes/todos.js</code>.</p>
<h3 id="List-GET-todos"><a href="#List-GET-todos" class="headerlink" title="List: GET /todos"></a>List: GET /todos</h3><p>Remember <a href="#mongoose-read-and-query"> mongoose query api</a>? Hereâ€™s how to use it in this context:</p>
<figure class="highlight javascript"><figcaption><span>routes/todos.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.Router();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> mongoose = <span class="built_in">require</span>(<span class="string">&#x27;mongoose&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> Todo = <span class="built_in">require</span>(<span class="string">&#x27;../models/Todo.js&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* GET /todos listing. */</span></span><br><span class="line">router.get(<span class="string">&#x27;/&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  Todo.find(<span class="function"><span class="keyword">function</span> (<span class="params">err, todos</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">return</span> next(err);</span><br><span class="line">    res.json(todos);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router;</span><br></pre></td></tr></table></figure>

<p>Harvest time! We donâ€™t have any task in database but at least we verify it is working:</p>
<figure class="highlight bash"><figcaption><span>Testing all together</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Start database</span></span><br><span class="line">mongod</span><br><span class="line"></span><br><span class="line"><span class="comment">## Start Webserver (in other terminal tab)</span></span><br><span class="line">npm start</span><br><span class="line"></span><br><span class="line"><span class="comment">## Test API (in other terminal tab)</span></span><br><span class="line">curl localhost:3000/todos</span><br><span class="line"><span class="comment">## =&gt; []%</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/amejiarosario/todoAPIjs/commit/54ab912ea9aa2b6633ae12816beb6e6c3d2702e6">diff</a></p>
<p>If it returns an empty array <code>[]</code> you are all set. If you get errors, try going back and making sure you didnâ€™t forget anything, or you can comment at the end of the post for help.</p>
<h3 id="Create-POST-todos"><a href="#Create-POST-todos" class="headerlink" title="Create: POST /todos"></a>Create: POST /todos</h3><p>Back in <code>routes/todos.js</code>, we are going to add the ability to create using <a href="#mongoose-create">mongoose create</a>. Can you make it work before looking at the next example?</p>
<figure class="highlight javascript"><figcaption><span>routes/todos.js (showing just create route)</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/* POST /todos */</span></span><br><span class="line">router.post(<span class="string">&#x27;/&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  Todo.create(req.body, <span class="function"><span class="keyword">function</span> (<span class="params">err, post</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">return</span> next(err);</span><br><span class="line">    res.json(post);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/amejiarosario/todoAPIjs/commit/28b60c4bf9c6d8b08c3351f725e17c7f40a077be">diff</a></p>
<p>A few things:</p>
<ul>
<li>We are using the <code>router.post</code> instead of <code>router.get</code>.</li>
<li>You have to stop and run the server again: <code>npm start</code>.</li>
</ul>
<p>Everytime you change a file you have to stop and start the web server. Letâ€™s fix that using <code>nodemon</code> to refresh automatically:</p>
<figure class="highlight bash"><figcaption><span>Nodemon</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## install nodemon globally</span></span><br><span class="line">npm install nodemon -g</span><br><span class="line"></span><br><span class="line"><span class="comment">## Run web server with nodemon</span></span><br><span class="line">nodemon</span><br></pre></td></tr></table></figure>

<h3 id="Show-GET-todos-id"><a href="#Show-GET-todos-id" class="headerlink" title="Show: GET /todos/:id"></a>Show: GET /todos/:id</h3><p>This is a snap with <a href="#mongoose-read-and-query"><code>Todo.findById</code></a> and <code>req.params</code>. Notice that <code>params</code> matches the placeholder name we set while defining the route. <code>:id</code> in this case.</p>
<figure class="highlight javascript"><figcaption><span>routes/todos.js (showing just show route)</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* GET /todos/id */</span></span><br><span class="line">router.get(<span class="string">&#x27;/:id&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  Todo.findById(req.params.id, <span class="function"><span class="keyword">function</span> (<span class="params">err, post</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">return</span> next(err);</span><br><span class="line">    res.json(post);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/amejiarosario/todoAPIjs/commit/7d8bc67178a4f162858395845c076d9223926bf8">diff</a></p>
<p>Letâ€™s test what we have so far!</p>
<figure class="highlight bash"><figcaption><span>Testing the API with Curl</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Start Web Server on port 4000 (default is 3000)</span></span><br><span class="line">PORT=4000 nodemon</span><br><span class="line"></span><br><span class="line"><span class="comment">## Create a todo using the API</span></span><br><span class="line">curl -XPOST http://localhost:4000/todos -d <span class="string">&#x27;name=Master%20Routes&amp;completed=false&amp;note=soon...&#x27;</span></span><br><span class="line"><span class="comment">## =&gt; &#123;&quot;__v&quot;:0,&quot;name&quot;:&quot;Master Routes&quot;,&quot;completed&quot;:false,&quot;note&quot;:&quot;soon...&quot;,&quot;_id&quot;:&quot;57a655997d2241695585ecf8&quot;&#125;%</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Get todo by ID (use the _id from the previous request, in my case &quot;57a655997d2241695585ecf8&quot;)</span></span><br><span class="line">curl -XGET http://localhost:4000/todos/57a655997d2241695585ecf8</span><br><span class="line">&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;57a655997d2241695585ecf8&quot;</span>,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;Master Routes&quot;</span>,<span class="string">&quot;completed&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;note&quot;</span>:<span class="string">&quot;soon...&quot;</span>,<span class="string">&quot;__v&quot;</span>:0&#125;%</span><br><span class="line"></span><br><span class="line"><span class="comment">## Get all elements (notice it is an array)</span></span><br><span class="line">curl -XGET http://localhost:4000/todos</span><br><span class="line">[&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;57a655997d2241695585ecf8&quot;</span>,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;Master Routes&quot;</span>,<span class="string">&quot;completed&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;note&quot;</span>:<span class="string">&quot;soon...&quot;</span>,<span class="string">&quot;__v&quot;</span>:0&#125;]%</span><br></pre></td></tr></table></figure>

<h3 id="Update-PUT-todos-id"><a href="#Update-PUT-todos-id" class="headerlink" title="Update: PUT /todos/:id"></a>Update: PUT /todos/:id</h3><p>Back in <code>routes/todos.js</code>, we are going to update tasks. This one you can do without looking at the example below, review <a href="#mongoose-update">findByIdAndUpdate</a> and give it a try!</p>
<figure class="highlight javascript"><figcaption><span>routes/todos.js (showing just update route)</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* PUT /todos/:id */</span></span><br><span class="line">router.put(<span class="string">&#x27;/:id&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  Todo.findByIdAndUpdate(req.params.id, req.body, <span class="function"><span class="keyword">function</span> (<span class="params">err, post</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">return</span> next(err);</span><br><span class="line">    res.json(post);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/amejiarosario/todoAPIjs/commit/00dafe491e0d0b59fa53e86d8c187c42d7824200">diff</a></p>
<figure class="highlight bash"><figcaption><span>curl update</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Use the ID from the todo, in my case 57a655997d2241695585ecf8</span></span><br><span class="line">curl -XPUT http://localhost:4000/todos/57a655997d2241695585ecf8 -d <span class="string">&quot;note=hola&quot;</span></span><br><span class="line"><span class="comment">## =&gt; &#123;&quot;_id&quot;:&quot;57a655997d2241695585ecf8&quot;,&quot;name&quot;:&quot;Master Routes&quot;,&quot;completed&quot;:true,&quot;note&quot;:&quot;hola&quot;,&quot;__v&quot;:0&#125;%</span></span><br></pre></td></tr></table></figure>

<h3 id="Destroy-DELETE-todos-id"><a href="#Destroy-DELETE-todos-id" class="headerlink" title="Destroy: DELETE /todos/:id"></a>Destroy: DELETE /todos/:id</h3><p>Finally, the last one! Almost identical to <code>update</code>, use <a href="#mongoose-delete"><code>findByIdAndRemove</code></a>.</p>
<figure class="highlight javascript"><figcaption><span>routes/todos.js (showing just update route)</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* DELETE /todos/:id */</span></span><br><span class="line">router.delete(<span class="string">&#x27;/:id&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  Todo.findByIdAndRemove(req.params.id, req.body, <span class="function"><span class="keyword">function</span> (<span class="params">err, post</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">return</span> next(err);</span><br><span class="line">    res.json(post);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/amejiarosario/todoAPIjs/commit/cbf5366e2b4e1a683ed50d2148ed6a548616d3f8">diff</a></p>
<p>Is it working? Cool, you are done then!
Is NOT working? take a look at the <a target="_blank" rel="noopener" href="https://github.com/amejiarosario/todoAPIjs">full repository</a>.</p>
<h2 id="Whatâ€™s-next"><a href="#Whatâ€™s-next" class="headerlink" title="Whatâ€™s next?"></a>Whatâ€™s next?</h2><p>Connecting AngularJS with this endpoint. Check out the <a href="/blog/2014/10/03/mean-stack-tutorial-mongodb-expressjs-angularjs-nodejs">third</a> tutorial in this series.</p>

      </div>

      <!-- after post -->
      <div class="hidden-mobile-down">
        <h3>Now, your turn!</h3>
        Thanks for reading this far. Here are some things you can do next:

        <ul>
          <li>Found a typo?
            <a target="_blank" rel="noopener" href="https://github.com/amejiarosario/amejiarosario.github.io/edit/source/source/_posts/2014-10-01-creating-a-restful-api-tutorial-with-nodejs-and-mongodb.markdown">
              Edit this post</a>.
          </li>
          <li>Got questions?
            <a href="#comments-section">comment</a>
            below.
          </li>
          <li>
            Was it useful? Show your
            <!-- <a href="/support">support</a>  -->
            support and share it.
            <!-- <a target="_blank" href="http://paypal.me/amejiarosario">Paypal</a>, -->
            <!-- <a target="_blank" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=HZLFWQAFENN7W&source=url">Paypal</a>,
            <a target="_blank" href="https://bitaps.com/3A8xanut3wddz1jJ7JWSw8nwwpUahLJpZi">Bitcoin</a>,
            <a target="_blank" href="https://www.patreon.com/amejiarosario">Patreon</a>. -->
          </li>
        </ul>
      </div>

      <div class="hidden-mobile-up">
        <a target="_blank" rel="noopener" href="https://books.adrianmejia.com">
          <!-- <img src="/images/data-structure-algorithms-javascript-presell.jpg" alt="Data Structure and Algorithms in JavaScript eBook"> -->
          <img src="/images/data-structure-algorithms-banner.jpg" alt="Data Structure and Algorithms in JavaScript eBook">
        </a>
      </div>

      <!-- Next and previous posts -->
      
        <div class="article-nav m-y-4">
          
            <a href="/mean-stack-tutorial-mongodb-expressjs-angularjs-nodejs/" class="article-nav-newer" class="article-nav-link-wrap">
              <strong class="article-nav-caption"><i class="fa fa-chevron-left"></i> newer</strong>
              <div class="article-nav-title">
                
                  MEAN Stack Tutorial MongoDB ExpressJS AngularJS NodeJS (Part III)
                
              </div>
            </a>
          
          
            <a href="/angularjs-tutorial-for-beginners-with-nodejs-expressjs-and-mongodb/" class="article-nav-older" class="article-nav-link-wrap">
              <strong class="article-nav-caption">older <i class="fa fa-chevron-right"></i></strong>
              <div class="article-nav-title">AngularJS tutorial for beginners with NodeJS ExpressJS and MongoDB (Part I)</div>
            </a>
          
        </div>
      

      

        <!-- Related -->
        <footer>
          <!-- subscribe -->
          <div class="m-y-4">
            <!-- Begin MailChimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
	#mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; width:100%;}
	/* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<form action="//adrianmejia.us2.list-manage.com/subscribe/post?u=2294bb28c5931a6f2338d2474&amp;id=52678e825b" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" novalidate>
    <div id="mc_embed_signup_scroll">
	<label for="mce-EMAIL">Subscribe &amp; stay up to date!</label>
	<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_2294bb28c5931a6f2338d2474_52678e825b" tabindex="-1" value=""></div>
    <div class="clear">&nbsp;<input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>
<!--End mc_embed_signup-->

<script type="text/javascript">
  var form = document.getElementById('mc-embedded-subscribe-form');
  form.addEventListener('submit', function(event) {
    event.preventDefault();
    ga('send', 'event', 'newsletter', 'signup', 'page', {
      hitCallback: createFunctionWithTimeout(function() {
        form.submit();
      })
    });
  });
</script>

          </div>

          <!-- Author Bio -->
          <b>About the author</b>
          
              <!-- Adrian Mejia Bio -->
            
<section class="bio-box">
  <img class="m-a-1 not-scaled" src="/images/adrian-mejia-headshot.png" alt="Adrian Mejia">
  <article class="p-x-1" style="display: flex; flex-direction:column;">
    <p class="muted">Adrian Mejia is a Software Engineer located in Boston, MA.
      Currently working at Google.
      Adrian enjoys writing posts about Algorithms, programming, JavaScript, and Web Dev.
      Also, he likes to travel âœˆï¸ and biking ðŸš´â€.
      <!-- Find out more <a href="/#about">here</a>. -->
    </p>
    <!-- <p class="m-y-0"><a target="_blank" rel="noopener" href="https://twitter.com/iAmAdrianMejia">Follow him on Twitter</a>.</p> -->
    <a target="_blank" rel="noopener" href="https://twitter.com/iAmAdrianMejia" id="twitter-follow-button" class="twitter-follow-button" data-show-count="false">Follow @iAmAdrianMejia</a>&nbsp;
  </article>
</section>

          

          <div class="m-y-4">
            
              
                <div class="container">
                <h1 class="capitalize">tutorial mean stack Series</h1>
                <div class="row">
              

              <!-- <ol> -->
              <article class="col-md-6 col-sm-6 card">
  <a href="/angularjs-tutorial-for-beginners-with-nodejs-expressjs-and-mongodb/">
    
      <img src="/images/AngularJSTutorial_small.png" width="300" height="250">
      <section class="p-a-1">
        <h3>AngularJS tutorial for beginners with NodeJS ExpressJS and MongoDB (Part I)</h3>
      </section>
    
  </a>
</article>

              <!-- </ol> -->

              
            
              

              <!-- <ol> -->
              <article class="col-md-6 col-sm-6 card">
  <a href="/creating-a-restful-api-tutorial-with-nodejs-and-mongodb/">
    
      <img src="/images/RESTfulAPIs_NodeJS__mongodb_small.png" width="300" height="250">
      <section class="p-a-1">
        <h3>Creating RESTful APIs with NodeJS and MongoDB Tutorial (Part II)</h3>
      </section>
    
  </a>
</article>

              <!-- </ol> -->

              
            
              

              <!-- <ol> -->
              <article class="col-md-6 col-sm-6 card">
  <a href="/mean-stack-tutorial-mongodb-expressjs-angularjs-nodejs/">
    
      <img src="/images/mean_small.png" width="300" height="250">
      <section class="p-a-1">
        <h3>MEAN Stack Tutorial MongoDB ExpressJS AngularJS NodeJS (Part III)</h3>
      </section>
    
  </a>
</article>

              <!-- </ol> -->

              
              </div><!-- .row -->
              </div><!-- .container -->
              
            
          </div>

          <!-- 726x88 -->
          <!---->
          <!--<script data-cfasync="false" type="text/javascript" src="(DISABLED)//www.eboundservices.com/ads/728x90_non_responsive.js"></script>-->
<!--           <div class="hidden-mobile-down">
            <script data-cfasync="false" type="text/javascript" src="(DISABLED)//www.eboundservices.com/ads/728x90_responsive.js"></script>
          </div> -->
          <!--<script data-cfasync="false" type="text/javascript" src="//www.eboundservices.com/ads/336x280_responsive.js"></script>-->


          <!-- last working ads -->
          <!-- <script data-cfasync="false" type="text/javascript" src="//www.eboundservices.com/ads/dfp/336x280_responsive.js"></script> -->


        </footer>

      <!-- if(page.layout !== 'snippet') -->
    </section>

    <!-- Asides (Ads, TOC, ...) -->
    <aside class="col-sm-4 p-x-2 col-xs-order-1">
      <section>

        <!-- 300x250 -->
        <!---->
        <!--<script data-cfasync="false" type="text/javascript" src="//www.eboundservices.com/ads/300x250_non_responsive.js"></script>-->
        <!--<div class="hidden-mobile-down">-->
          <!--<script data-cfasync="false" type="text/javascript" src="//www.eboundservices.com/ads/300x250_responsive.js"></script>-->
        <!--</div>-->

        <!--<div class="hidden-mobile-up">-->
        <!--<script data-cfasync="false" type="text/javascript" src="//www.eboundservices.com/ads/336x280_responsive.js"></script>-->
        <!--</div>-->

        <!-- last working ads -->
        <!-- <script data-cfasync="false" type="text/javascript" src="//www.eboundservices.com/ads/dfp/336x280_responsive.js"></script> -->

      </section>

      <section class="sticky-element--start">
        <div class="muted">
          <div class="p-y-1">
            <a href="#" class=""><span id="back-to-top" title="Go back to the top of this page">
              <i class="fa fa-arrow-up"></i> Top
            </span></a>

            <a href="#" class="p-x-3" title="Improve this post" onclick="track('https://github.com/amejiarosario/amejiarosario.github.io/edit/source/source/_posts/2014-10-01-creating-a-restful-api-tutorial-with-nodejs-and-mongodb.markdown')">
              <i class="fa fa-pencil"></i> Edit this post
            </a>
            <!-- <a href="#" title="Share this post"><i class="fa fa-share"></i> Share</a> -->
            <!--<div class="p-y-1">-->
              <!---->
              <!---->
              <!---->
              <!---->
            <!--</div>-->
          </div>

          
            <h3 class="toc-title">Contents</h3>
            <div>
              <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#What-is-a-RESTful-API"><span class="toc-number">1.</span> <span class="toc-text">What is a RESTful API?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Installing-the-MEAN-Stack-Backend"><span class="toc-number">2.</span> <span class="toc-text">Installing the MEAN Stack Backend</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Installing-MongoDB"><span class="toc-number">2.1.</span> <span class="toc-text">Installing MongoDB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Installing-NodeJS"><span class="toc-number">2.2.</span> <span class="toc-text">Installing NodeJS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Installing-ExpressJS"><span class="toc-number">2.3.</span> <span class="toc-text">Installing ExpressJS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Using-MongoDB-with-Mongoose"><span class="toc-number">3.</span> <span class="toc-text">Using MongoDB with Mongoose</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Mongoose-CRUD"><span class="toc-number">3.1.</span> <span class="toc-text">Mongoose CRUD</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mongoose-Create"><span class="toc-number">3.2.</span> <span class="toc-text">Mongoose Create</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mongoose-Read-and-Query"><span class="toc-number">3.3.</span> <span class="toc-text">Mongoose Read and Query</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mongoose-Update"><span class="toc-number">3.4.</span> <span class="toc-text">Mongoose Update</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mongoose-Delete"><span class="toc-number">3.5.</span> <span class="toc-text">Mongoose Delete</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ExpressJS-and-Middlewares"><span class="toc-number">4.</span> <span class="toc-text">ExpressJS and Middlewares</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Default-Express-4-0-middlewares"><span class="toc-number">4.1.</span> <span class="toc-text">Default Express 4.0 middlewares</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Other-ExpressJS-Middlewares"><span class="toc-number">4.2.</span> <span class="toc-text">Other ExpressJS Middlewares</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Wiring-up-the-MEAN-Stack"><span class="toc-number">5.</span> <span class="toc-text">Wiring up the MEAN Stack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Bootstrapping-ExpressJS"><span class="toc-number">5.1.</span> <span class="toc-text">Bootstrapping ExpressJS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Connect-ExpressJS-to-MongoDB"><span class="toc-number">5.2.</span> <span class="toc-text">Connect ExpressJS to MongoDB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Creating-the-Todo-model-with-Mongoose"><span class="toc-number">5.3.</span> <span class="toc-text">Creating the Todo model with Mongoose</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#API-clients-Browser-Postman-and-curl"><span class="toc-number">6.</span> <span class="toc-text">API clients (Browser, Postman and curl)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Curl"><span class="toc-number">6.1.</span> <span class="toc-text">Curl</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Browser-and-Postman"><span class="toc-number">6.2.</span> <span class="toc-text">Browser and Postman</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Websites-and-Mobile-Apps"><span class="toc-number">6.3.</span> <span class="toc-text">Websites and Mobile Apps</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ExpressJS-Routes"><span class="toc-number">7.</span> <span class="toc-text">ExpressJS Routes</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#List-GET-todos"><span class="toc-number">7.1.</span> <span class="toc-text">List: GET &#x2F;todos</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Create-POST-todos"><span class="toc-number">7.2.</span> <span class="toc-text">Create: POST &#x2F;todos</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Show-GET-todos-id"><span class="toc-number">7.3.</span> <span class="toc-text">Show: GET &#x2F;todos&#x2F;:id</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Update-PUT-todos-id"><span class="toc-number">7.4.</span> <span class="toc-text">Update: PUT &#x2F;todos&#x2F;:id</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Destroy-DELETE-todos-id"><span class="toc-number">7.5.</span> <span class="toc-text">Destroy: DELETE &#x2F;todos&#x2F;:id</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#What%E2%80%99s-next"><span class="toc-number">8.</span> <span class="toc-text">Whatâ€™s next?</span></a></li></ol>
            </div>

            <!-- 300x600 -->
            <!---->
            <!--<script data-cfasync="false" type="text/javascript" src="(DISABLED)//www.eboundservices.com/ads/300x600_non_responsive.js"></script>-->
            <div class="hidden-mobile-down">
              <!-- last working ads -->
              <!-- <script data-cfasync="false" type="text/javascript" src="//www.eboundservices.com/ads/dfp/160x600_responsive.js"></script> -->

              <a href="https://books.adrianmejia.com" target="_blank">
                <!-- <img src="/images/data-structure-algorithms-javascript-presell.jpg" alt="Data Structure and Algorithms in JavaScript eBook"> -->
                <img src="/images/data-structure-algorithms-banner.jpg" alt="Data Structure and Algorithms in JavaScript eBook">
              </a>
            </div>
          
        </div>
      </section>
    </aside>
  </div>

  <!-- comments -->
  <a id="comments-section"></a>
  <footer class="row sticky-element--end">
    <div class="col-xs-12">
      <section>
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'https://adrianmejia.com/creating-a-restful-api-tutorial-with-nodejs-and-mongodb/';
      this.page.identifier = 'https://adrianmejia.com/creating-a-restful-api-tutorial-with-nodejs-and-mongodb/';
    };
    (function() {
      var d = document, s = d.createElement('script');
      s.src = '//adrianmejia.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a target="_blank" href="https://disqus.com/?ref_noscript" rel="nofollow noopener">comments powered by Disqus.</a></noscript>
</section>

    </div>
  </footer>
</article>

    </main>

    <!-- uxa -->
    <!-- <img src="//data.uxeranalytics.com/image1.png?uxa=blog" id="pxl1"> -->
    <!-- <script async defer src="//data.uxeranalytics.com/uxa.js"></script> -->
    <!-- /uxa -->

    <footer class="page-footer">
      <div class="container">
        <div class="p-y-2">
          &copy; 2021 <a href="http://adrianmejia.com">Adrian Mejia</a>
          <span class="muted m-x-4" title="Thu Jul 08 2021 20:14:52 GMT-0400 (Eastern Daylight Time)">
            v.qvybcs
          </span>
        </div>
      </div>
    </footer>

    <!-- Scripts -->
    
<script src="/js/main.babel.js"></script>
    <script id="dsq-count-scr" src="//adrianmejia.disqus.com/count.js" async></script>
    <!-- Algolia Search -->
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/instantsearch.js/1/instantsearch.min.css" />
    <script src="//cdn.jsdelivr.net/instantsearch.js/1/instantsearch.min.js"></script>
    
<link rel="stylesheet" href="/stylesheets/55_search.css">



    <!-- social scripts -->
    <script async defer src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
    

    
      <!-- <script src="https://gumroad.com/js/gumroad.js"></script> -->

      <!-- adthis -->
      <script type="text/javascript">
        var addthis_config = {
          data_ga_property: 'UA-24183929-4',
          data_ga_social : true
        };
      </script>
      <script async defer type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-579cb31b46e2f7e6"></script>

      
<script src="/js/posts.babel.js"></script>
      
<script src="/js/posts2.babel.js"></script>
    
  </body>
</html>
